(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{jkDv:function(t,e,i){"use strict";i.r(e),i.d(e,"AdminModule",function(){return pi});var r=i("ofXK"),s=i("tyNb"),o=i("mrSG"),n=i("0IaG"),a=i("3Pt+"),c=i("JX91"),l=i("lJxs"),d=i("fXoL"),h=i("3YJ2");let u=(()=>{class t{constructor(t){this.resourceService=t}getListarRolesQueFaltanEnEstrategia(t){let e=[];return new Promise((i,r)=>{this.resourceService.getResource("/estrategia/listarRolesQueFaltanEnEstrategia?id_estrategia="+t.id).toPromise().then(t=>{t&&0!==Object.keys(t).length?(e=t.lista,i(e)):(console.log("no roles encontradss..."),i([]))}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),r(t)})})}getListarRolesAsignadosxEstrategia(t){let e=[];return new Promise((i,r)=>{this.resourceService.getResource("/estrategia/listarEstrategiaRolYRolPorId?id_estrategia="+t.id).toPromise().then(t=>{t&&0!==Object.keys(t).length?(e=t.lista,i(e)):(console.log("no roles asignados encontradss..."),i([]))}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),r(t)})})}crearRolEstrategia(t){var e;console.log("adding Rol a Estrategia..."+JSON.stringify(t));let i={orden:t.orden,id_rol:t.rol.id,id_estrategia:null===(e=t.estrategia)||void 0===e?void 0:e.id};return console.log("sending Rol a Estrategia..."+JSON.stringify(i)),new Promise((t,e)=>{this.resourceService.postResource("/estrategia/crearEstrategiaRol",i).toPromise().then(e=>{console.log("response data="+JSON.stringify(e)),t(e)}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),e(t)})})}actualizarListadoRolAsignadoxEstrategia(t){return console.log("adding Rol a Estrategia..."+JSON.stringify(t)),new Promise((e,i)=>{this.resourceService.postResource("/estrategia/actualizarRolesDeEstrategia",t).toPromise().then(t=>{e(t)}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),i(t)})})}actualizarActivoDeEstrategiaRol(t){return console.log("sending Rol a Estrategia..."+JSON.stringify(t)),new Promise((e,i)=>{this.resourceService.postResource("/estrategia/actualizarActivoDeEstrategiaRol",t).toPromise().then(t=>{console.log("response data="+JSON.stringify(t)),e(t)}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),i(t)})})}getListarRolesActivosDeEstrategiaSinUsuarioExceptoSolicitantePorId(t){return new Promise((e,i)=>{this.resourceService.getResource("/estrategia/listarRolesActivosDeEstrategiaSinUsuarioExceptoSolicitantePorId?id_estrategia="+t.id).toPromise().then(t=>{t&&0!==Object.keys(t).length&&e(t)}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),i(t)})})}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(h.a))},t.\u0275prov=d.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),g=(()=>{class t{constructor(t){this.resourceService=t}getListarUsuarioConRolPorIdEstrategia(t){let e;return new Promise((i,r)=>{this.resourceService.getResource("/estrategia/listarUsuarioConRolPorIdEstrategia?id_estrategia="+t.id).toPromise().then(t=>{t&&0!==Object.keys(t).length?(e=t,i(e)):(console.log("no roles asignados encontradss..."),i([]))}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),r(t)})})}getListarUsuariosQueNoEstanAsignadosAUnaEstrategiaPorId(t){return new Promise((e,i)=>{this.resourceService.getResource("/estrategia/listarUsuariosQueNoEstanAsignadosAUnaEstrategiaPorId?id_estrategia="+t.id).toPromise().then(t=>{t&&0!==Object.keys(t).length?e(t):(console.log("no roles asignados encontradss..."),e([]))}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),i(t)})})}crearUsuarioARolDeEstrategia(t){var e;let i={id_usuario:t.usuario.id,id_estrategia_rol:null===(e=t.estrategia_rol)||void 0===e?void 0:e.id};return console.log("sending Rol a Estrategia..."+JSON.stringify(i)),new Promise((t,e)=>{this.resourceService.postResource("/estrategia/agregarUsuarioARolDeEstrategia",i).toPromise().then(e=>{console.log("response data="+JSON.stringify(e)),t(e)}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),e(t)})})}actualizarActivoDeEstrategiaRolUsuario(t){var e;let i={id_usuario:t.usuario.id,id_estrategia_rol:null===(e=t.estrategia_rol)||void 0===e?void 0:e.id,activo:null};return console.log("sending Rol a Estrategia..."+JSON.stringify(i)),new Promise((t,e)=>{this.resourceService.postResource("/estrategia/actualizarActivoDeEstrategiaRolUsuario",i).toPromise().then(e=>{console.log("response data="+JSON.stringify(e)),t(e)}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),e(t)})})}getListarRolesAnteriores(t,e){return new Promise((i,r)=>{this.resourceService.getResource("/rol/listarRolesAnteriores?id_solicitud="+t+"&orden="+e).toPromise().then(t=>{t&&0!==Object.keys(t).length?i(t):(console.log("no roles encontrados..."),i([]))}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),r(t)})})}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(h.a))},t.\u0275prov=d.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var b=i("kmnG"),m=i("d3UM"),p=i("qFsG"),f=i("/1cH"),_=i("bTqV"),v=i("+0xr"),S=i("FKr1"),C=i("NFeN"),E=i("Xa2L");function D(t,e){if(1&t&&(d.Tb(0,"mat-option",19),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.kc("value",t),d.Cb(1),d.Dc(" ",t.nombre," ")}}function R(t,e){if(1&t&&(d.Tb(0,"mat-option",19),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.kc("value",t),d.Cb(1),d.Dc(" ",t.nombre," ")}}function P(t,e){1&t&&(d.Tb(0,"th",20),d.Bc(1," Rol"),d.Sb())}function T(t,e){if(1&t&&(d.Tb(0,"td",21),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.Cb(1),d.Dc(" ",t.estrategia_rol.rol.nombre," ")}}function w(t,e){1&t&&(d.Tb(0,"th",20),d.Bc(1," Usuario"),d.Sb())}function y(t,e){if(1&t&&(d.Tb(0,"td",21),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.Cb(1),d.Dc(" ",t.usuario.nombre," ")}}function x(t,e){1&t&&(d.Tb(0,"th",20),d.Bc(1," Acciones "),d.Sb())}function O(t,e){if(1&t){const t=d.Ub();d.Tb(0,"td",21),d.Tb(1,"button",22),d.ac("click",function(){d.tc(t);const i=e.$implicit;return d.ec().eliminarUsuario(i)}),d.Tb(2,"mat-icon"),d.Bc(3,"delete"),d.Sb(),d.Sb(),d.Sb()}}function k(t,e){1&t&&d.Ob(0,"tr",23)}function A(t,e){1&t&&d.Ob(0,"tr",24)}function I(t,e){1&t&&d.Ob(0,"mat-spinner",25)}let N=(()=>{class t{constructor(t,e,i,r){this.dialogRef=t,this.data=e,this.rolEstrategiaService=i,this.usuarioRolService=r,this.comboListadoUsuario=[],this.carga=!1,this.listadoUsuarioRol=[],this.contadorId=0,this.myControl=new a.e,this.displayedColumns=["rol","usuario","id"],this.comboRolesxEstrategia=[],this.estrategia=e.estrategia,this.listarRolesActivosDeEstrategiaSinUsuarioExceptoSolicitantePorId(),this.listarUsuarioConRolPorIdEstrategia()}ngOnInit(){return Object(o.a)(this,void 0,void 0,function*(){let t=yield this.usuarioRolService.getListarUsuariosQueNoEstanAsignadosAUnaEstrategiaPorId(this.estrategia);this.comboListadoUsuario=t.lista,this.filteredUsuario=this.myControl.valueChanges.pipe(Object(c.a)(""),Object(l.a)(t=>"string"==typeof t?t:t.nombre),Object(l.a)(t=>t?this._filter(t):this.comboListadoUsuario.slice()))})}listarRolesActivosDeEstrategiaSinUsuarioExceptoSolicitantePorId(){return Object(o.a)(this,void 0,void 0,function*(){this.rolEstrategiaService.getListarRolesActivosDeEstrategiaSinUsuarioExceptoSolicitantePorId(this.estrategia).then(t=>{this.comboRolesxEstrategia=t.lista,console.log("roles---\x3e"+JSON.stringify(this.comboRolesxEstrategia))})})}getListarUsuariosQueNoEstanAsignadosAUnaEstrategiaPorId(){return Object(o.a)(this,void 0,void 0,function*(){this.usuarioRolService.getListarUsuariosQueNoEstanAsignadosAUnaEstrategiaPorId(this.estrategia).then(t=>{this.comboListadoUsuario=t.lista,console.log("usuarios---\x3e"+JSON.stringify(this.comboListadoUsuario))})})}listarUsuarioConRolPorIdEstrategia(){return Object(o.a)(this,void 0,void 0,function*(){this.usuarioRolService.getListarUsuarioConRolPorIdEstrategia(this.estrategia).then(t=>{this.listadoUsuarioRol=t.lista,console.log("listando getListarUsuarioConRolPorIdEstrategia--\x3e"+JSON.stringify(this.listadoUsuarioRol))})})}agregarUsuarioRol(t,e){console.log("item usuario:"+JSON.stringify(t)),console.log("item Rol Estrategia:"+JSON.stringify(e)),this.usuarioRolService.crearUsuarioARolDeEstrategia({usuario:t,estrategia_rol:e}).then(()=>{this.listarRolesActivosDeEstrategiaSinUsuarioExceptoSolicitantePorId(),this.getListarUsuariosQueNoEstanAsignadosAUnaEstrategiaPorId(),this.listarUsuarioConRolPorIdEstrategia()})}eliminarUsuario(t){this.usuarioRolService.actualizarActivoDeEstrategiaRolUsuario(t).then(t=>{this.listarRolesActivosDeEstrategiaSinUsuarioExceptoSolicitantePorId(),this.getListarUsuariosQueNoEstanAsignadosAUnaEstrategiaPorId(),this.listarUsuarioConRolPorIdEstrategia()})}removeItem(t){let e=[];this.comboListadoUsuario.forEach(i=>{i.nombre!=t.nombre&&e.push({id:i.id,nombre:i.nombre})}),this.comboListadoUsuario=e,this.selectedUsuario={}}displayFn(t){return t&&t.nombre?t.nombre:""}_filter(t){const e=t.toLowerCase();return this.comboListadoUsuario.filter(t=>0===t.nombre.toLowerCase().indexOf(e))}onNoClick(){this.dialogRef.close(this.listadoUsuarioRol)}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(n.d),d.Nb(n.a),d.Nb(u),d.Nb(g))},t.\u0275cmp=d.Hb({type:t,selectors:[["app-asignar-usuarios"]],decls:34,vars:13,consts:[["appearance","fill"],["name","item",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill",1,"example-full-width"],["type","text","matInput","",3,"formControl","matAutocomplete","ngModel","ngModelChange"],[3,"displayWith"],["auto","matAutocomplete"],["mat-button","",3,"click"],[1,"content-table"],["mat-table","",1,"at-elevation-z8",3,"dataSource"],["matColumnDef","rol"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","usuario"],["matColumnDef","id"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","spinner","diameter","40","color","accent","strokeWidth","7",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"],[3,"value"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","accent",3,"click"],["mat-header-row",""],["mat-row",""],["diameter","40","color","accent","strokeWidth","7",1,"spinner"]],template:function(t,e){if(1&t&&(d.Tb(0,"mat-form-field",0),d.Tb(1,"mat-label"),d.Bc(2,"Seleccionar Rol"),d.Sb(),d.Tb(3,"mat-select",1),d.ac("ngModelChange",function(t){return e.selectedRolEstrategia=t}),d.Ac(4,D,2,2,"mat-option",2),d.Sb(),d.Sb(),d.Bc(5,"\n\xa0\n"),d.Tb(6,"mat-form-field",3),d.Tb(7,"mat-label"),d.Bc(8,"Usuario"),d.Sb(),d.Tb(9,"input",4),d.ac("ngModelChange",function(t){return e.selectedUsuario=t}),d.Sb(),d.Tb(10,"mat-autocomplete",5,6),d.Ac(12,R,2,2,"mat-option",2),d.fc(13,"async"),d.Sb(),d.Sb(),d.Tb(14,"div"),d.Tb(15,"button",7),d.ac("click",function(){return e.agregarUsuarioRol(e.selectedUsuario,e.selectedRolEstrategia)}),d.Bc(16,"Agregar"),d.Sb(),d.Sb(),d.Tb(17,"div",8),d.Tb(18,"table",9),d.Rb(19,10),d.Ac(20,P,2,0,"th",11),d.Ac(21,T,2,1,"td",12),d.Qb(),d.Rb(22,13),d.Ac(23,w,2,0,"th",11),d.Ac(24,y,2,1,"td",12),d.Qb(),d.Rb(25,14),d.Ac(26,x,2,0,"th",11),d.Ac(27,O,4,0,"td",12),d.Qb(),d.Ac(28,k,1,0,"tr",15),d.Ac(29,A,1,0,"tr",16),d.Sb(),d.Sb(),d.Ob(30,"br"),d.Ac(31,I,1,0,"mat-spinner",17),d.Tb(32,"button",18),d.ac("click",function(){return e.onNoClick()}),d.Bc(33,"Cerrar Ventana"),d.Sb()),2&t){const t=d.rc(11);d.Cb(3),d.kc("ngModel",e.selectedRolEstrategia),d.Cb(1),d.kc("ngForOf",e.comboRolesxEstrategia),d.Cb(5),d.kc("formControl",e.myControl)("matAutocomplete",t)("ngModel",e.selectedUsuario),d.Cb(1),d.kc("displayWith",e.displayFn),d.Cb(2),d.kc("ngForOf",d.gc(13,11,e.filteredUsuario)),d.Cb(6),d.kc("dataSource",e.listadoUsuarioRol),d.Cb(10),d.kc("matHeaderRowDef",e.displayedColumns),d.Cb(1),d.kc("matRowDefColumns",e.displayedColumns),d.Cb(2),d.kc("ngIf",e.carga)}},directives:[b.c,b.g,m.a,a.o,a.r,r.l,p.b,a.c,f.c,a.f,f.a,_.a,v.j,v.c,v.e,v.b,v.g,v.i,r.m,S.l,v.d,v.a,C.a,v.f,v.h,E.b],pipes:[r.b],styles:["table[_ngcontent-%COMP%]{width:100%}.content-table[_ngcontent-%COMP%]{min-width:400px;padding-left:5px;padding-right:5px;padding-top:10px}.spinner[_ngcontent-%COMP%]{position:relative;display:block;margin-left:448px;margin-bottom:10px}mat-form-field[_ngcontent-%COMP%]{width:47%}"]}),t})();var L=i("vxfF"),U=i("nLfN"),B=i("8LU1"),M=i("XNiG"),F=i("quSY"),j=i("HDdC"),z=i("D0XW"),q=i("Y7HM");function J(t){const{subscriber:e,counter:i,period:r}=t;e.next(i),this.schedule({subscriber:e,counter:i+1,period:r},r)}var G=i("eNwd"),H=i("VRyK"),V=i("1G5W"),$=i("IzEk"),Q=i("vkgz"),X=i("eIep"),W=i("cH1L");function Z(t,e){for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function Y(t,e){const i=e?"":"none";Z(t.style,{touchAction:e?"":"none",webkitUserDrag:e?"":"none",webkitTapHighlightColor:e?"":"transparent",userSelect:i,msUserSelect:i,webkitUserSelect:i,MozUserSelect:i})}function K(t,e){const i=t.style;i.position=e?"":"fixed",i.top=i.opacity=e?"":"0",i.left=e?"":"-999em"}function tt(t){const e=t.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(t)*e}function et(t,e){return t.getPropertyValue(e).split(",").map(t=>t.trim())}function it(t){const e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}}function rt(t,e,i){const{top:r,bottom:s,left:o,right:n}=t;return i>=r&&i<=s&&e>=o&&e<=n}function st(t,e,i){t.top+=e,t.bottom=t.top+t.height,t.left+=i,t.right=t.left+t.width}function ot(t,e,i,r){const{top:s,right:o,bottom:n,left:a,width:c,height:l}=t,d=c*e,h=l*e;return r>s-h&&r<n+h&&i>a-d&&i<o+d}class nt{constructor(t,e){this._document=t,this._viewportRuler=e,this.positions=new Map}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),t.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:it(t)})})}handleScroll(t){const e=t.target,i=this.positions.get(e);if(!i)return null;const r=e===this._document?e.documentElement:e,s=i.scrollPosition;let o,n;if(e===this._document){const t=this._viewportRuler.getViewportScrollPosition();o=t.top,n=t.left}else o=e.scrollTop,n=e.scrollLeft;const a=s.top-o,c=s.left-n;return this.positions.forEach((t,i)=>{t.clientRect&&e!==i&&r.contains(i)&&st(t.clientRect,a,c)}),s.top=o,s.left=n,{top:a,left:c}}}function at(t){const e=t.cloneNode(!0),i=e.querySelectorAll("[id]"),r=t.nodeName.toLowerCase();e.removeAttribute("id");for(let s=0;s<i.length;s++)i[s].removeAttribute("id");return"canvas"===r?ht(t,e):"input"!==r&&"select"!==r&&"textarea"!==r||dt(t,e),ct("canvas",t,e,ht),ct("input, textarea, select",t,e,dt),e}function ct(t,e,i,r){const s=e.querySelectorAll(t);if(s.length){const e=i.querySelectorAll(t);for(let t=0;t<s.length;t++)r(s[t],e[t])}}let lt=0;function dt(t,e){"file"!==e.type&&(e.value=t.value),"radio"===e.type&&e.name&&(e.name=`mat-clone-${e.name}-${lt++}`)}function ht(t,e){const i=e.getContext("2d");if(i)try{i.drawImage(t,0,0)}catch(r){}}const ut=Object(U.f)({passive:!0}),gt=Object(U.f)({passive:!1});class bt{constructor(t,e,i,r,s,o){this._config=e,this._document=i,this._ngZone=r,this._viewportRuler=s,this._dragDropRegistry=o,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._moveEvents=new M.a,this._pointerMoveSubscription=F.a.EMPTY,this._pointerUpSubscription=F.a.EMPTY,this._scrollSubscription=F.a.EMPTY,this._resizeSubscription=F.a.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new M.a,this.started=new M.a,this.released=new M.a,this.ended=new M.a,this.entered=new M.a,this.exited=new M.a,this.dropped=new M.a,this.moved=this._moveEvents,this._pointerDown=t=>{if(this.beforeStarted.next(),this._handles.length){const e=this._handles.find(e=>{const i=t.target;return!!i&&(i===e||e.contains(i))});!e||this._disabledHandles.has(e)||this.disabled||this._initializeDragSequence(e,t)}else this.disabled||this._initializeDragSequence(this._rootElement,t)},this._pointerMove=t=>{const e=this._getPointerPositionOnPage(t);if(!this._hasStartedDragging){if(Math.abs(e.x-this._pickupPositionOnPage.x)+Math.abs(e.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const e=Date.now()>=this._dragStartTime+this._getDragStartDelay(t),i=this._dropContainer;if(!e)return void this._endDragSequence(t);i&&(i.isDragging()||i.isReceiving())||(t.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(t)))}return}this._boundaryElement&&(this._previewRect&&(this._previewRect.width||this._previewRect.height)||(this._previewRect=(this._preview||this._rootElement).getBoundingClientRect())),t.preventDefault();const i=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(i),this._dropContainer)this._updateActiveDropContainer(i,e);else{const t=this._activeTransform;t.x=i.x-this._pickupPositionOnPage.x+this._passiveTransform.x,t.y=i.y-this._pickupPositionOnPage.y+this._passiveTransform.y,this._applyRootElementTransform(t.x,t.y),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&this._rootElement.setAttribute("transform",`translate(${t.x} ${t.y})`)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:i,event:t,distance:this._getDragDistance(i),delta:this._pointerDirectionDelta})})},this._pointerUp=t=>{this._endDragSequence(t)},this.withRootElement(t).withParent(e.parentDragRef||null),this._parentPositions=new nt(i,s),o.registerDragItem(this)}get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(t){const e=Object(B.c)(t);e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions(),this._handles.forEach(t=>Y(t,e)))}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){this._handles=t.map(t=>Object(B.e)(t)),this._handles.forEach(t=>Y(t,this.disabled)),this._toggleNativeDragInteractions();const e=new Set;return this._disabledHandles.forEach(t=>{this._handles.indexOf(t)>-1&&e.add(t)}),this._disabledHandles=e,this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){const e=Object(B.e)(t);return e!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{e.addEventListener("mousedown",this._pointerDown,gt),e.addEventListener("touchstart",this._pointerDown,ut)}),this._initialTransform=void 0,this._rootElement=e),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?Object(B.e)(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(t){return this._parentDragRef=t,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&ft(this._rootElement),ft(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(t){!this._disabledHandles.has(t)&&this._handles.indexOf(t)>-1&&(this._disabledHandles.add(t),Y(t,!0))}enableHandle(t){this._disabledHandles.has(t)&&(this._disabledHandles.delete(t),Y(t,this.disabled))}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){const t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}_sortFromLastPointerPosition(){const t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview&&ft(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder&&ft(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(t){this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging&&(this.released.next({source:this}),this._dropContainer?(this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)})):(this._passiveTransform.x=this._activeTransform.x,this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(this._getPointerPositionOnPage(t))})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this))))}_startDragSequence(t){_t(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const e=this._dropContainer;if(e){const t=this._rootElement,i=t.parentNode,r=this._preview=this._createPreviewElement(),s=this._placeholder=this._createPlaceholderElement(),o=this._anchor=this._anchor||this._document.createComment(""),n=this._getShadowRoot();i.insertBefore(o,t),K(t,!1),this._document.body.appendChild(i.replaceChild(s,t)),function(t,e){return e||t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement||t.msFullscreenElement||t.body}(this._document,n).appendChild(r),this.started.next({source:this}),e.start(),this._initialContainer=e,this._initialIndex=e.getItemIndex(this)}else this.started.next({source:this}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(e?e.getScrollableParents():[])}_initializeDragSequence(t,e){this._parentDragRef&&e.stopPropagation();const i=this.isDragging(),r=_t(e),s=!r&&0!==e.button,o=this._rootElement,n=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now();if(e.target&&e.target.draggable&&"mousedown"===e.type&&e.preventDefault(),i||s||n)return;this._handles.length&&(this._rootElementTapHighlight=o.style.webkitTapHighlightColor||"",o.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scroll.subscribe(t=>{this._updateOnScroll(t)}),this._boundaryElement&&(this._boundaryRect=it(this._boundaryElement));const a=this._previewTemplate;this._pickupPositionInElement=a&&a.template&&!a.matchSize?{x:0,y:0}:this._getPointerPositionInElement(t,e);const c=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:c.x,y:c.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(t){K(this._rootElement,!0),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=void 0,this._ngZone.run(()=>{const e=this._dropContainer,i=e.getItemIndex(this),r=this._getPointerPositionOnPage(t),s=this._getDragDistance(this._getPointerPositionOnPage(t)),o=e._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:s}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:o,distance:s}),e.drop(this,i,this._initialIndex,this._initialContainer,o,s),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:e},{x:i,y:r}){let s=this._initialContainer._getSiblingContainerFromPosition(this,t,e);!s&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,e)&&(s=this._initialContainer),s&&s!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=s,this._dropContainer.enter(this,t,e,s===this._initialContainer&&s.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:s,currentIndex:s.getItemIndex(this)})}),this._dropContainer._startScrollingIfNecessary(i,r),this._dropContainer._sortItem(this,t,e,this._pointerDirectionDelta),this._preview.style.transform=mt(t-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y)}_createPreviewElement(){const t=this._previewTemplate,e=this.previewClass,i=t?t.template:null;let r;if(i&&t){const e=t.matchSize?this._rootElement.getBoundingClientRect():null,s=t.viewContainer.createEmbeddedView(i,t.context);s.detectChanges(),r=vt(s,this._document),this._previewRef=s,t.matchSize?St(r,e):r.style.transform=mt(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{const t=this._rootElement;r=at(t),St(r,t.getBoundingClientRect())}return Z(r.style,{pointerEvents:"none",margin:"0",position:"fixed",top:"0",left:"0",zIndex:`${this._config.zIndex||1e3}`}),Y(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(t=>r.classList.add(t)):r.classList.add(e)),r}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const t=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._preview.style.transform=mt(t.left,t.top);const e=function(t){const e=getComputedStyle(t),i=et(e,"transition-property"),r=i.find(t=>"transform"===t||"all"===t);if(!r)return 0;const s=i.indexOf(r),o=et(e,"transition-duration"),n=et(e,"transition-delay");return tt(o[s])+tt(n[s])}(this._preview);return 0===e?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(t=>{const i=e=>{(!e||e.target===this._preview&&"transform"===e.propertyName)&&(this._preview.removeEventListener("transitionend",i),t(),clearTimeout(r))},r=setTimeout(i,1.5*e);this._preview.addEventListener("transitionend",i)}))}_createPlaceholderElement(){const t=this._placeholderTemplate,e=t?t.template:null;let i;return e?(this._placeholderRef=t.viewContainer.createEmbeddedView(e,t.context),this._placeholderRef.detectChanges(),i=vt(this._placeholderRef,this._document)):i=at(this._rootElement),i.classList.add("cdk-drag-placeholder"),i}_getPointerPositionInElement(t,e){const i=this._rootElement.getBoundingClientRect(),r=t===this._rootElement?null:t,s=r?r.getBoundingClientRect():i,o=_t(e)?e.targetTouches[0]:e,n=this._getViewportScrollPosition();return{x:s.left-i.left+(o.pageX-s.left-n.left),y:s.top-i.top+(o.pageY-s.top-n.top)}}_getPointerPositionOnPage(t){const e=this._getViewportScrollPosition(),i=_t(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,r=i.pageX-e.left,s=i.pageY-e.top;if(this._ownerSVGElement){const t=this._ownerSVGElement.getScreenCTM();if(t){const e=this._ownerSVGElement.createSVGPoint();return e.x=r,e.y=s,e.matrixTransform(t.inverse())}}return{x:r,y:s}}_getConstrainedPointerPosition(t){const e=this._dropContainer?this._dropContainer.lockAxis:null;let{x:i,y:r}=this.constrainPosition?this.constrainPosition(t,this):t;if("x"===this.lockAxis||"x"===e?r=this._pickupPositionOnPage.y:"y"!==this.lockAxis&&"y"!==e||(i=this._pickupPositionOnPage.x),this._boundaryRect){const{x:t,y:e}=this._pickupPositionInElement,s=this._boundaryRect,o=this._previewRect,n=s.top+e,a=s.bottom-(o.height-e);i=pt(i,s.left+t,s.right-(o.width-t)),r=pt(r,n,a)}return{x:i,y:r}}_updatePointerDirectionDelta(t){const{x:e,y:i}=t,r=this._pointerDirectionDelta,s=this._pointerPositionAtLastDirectionChange,o=Math.abs(e-s.x),n=Math.abs(i-s.y);return o>this._config.pointerDirectionChangeThreshold&&(r.x=e>s.x?1:-1,s.x=e),n>this._config.pointerDirectionChangeThreshold&&(r.y=i>s.y?1:-1,s.y=i),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,Y(this._rootElement,t))}_removeRootElementListeners(t){t.removeEventListener("mousedown",this._pointerDown,gt),t.removeEventListener("touchstart",this._pointerDown,ut)}_applyRootElementTransform(t,e){const i=mt(t,e);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform||""),this._rootElement.style.transform=this._initialTransform?i+" "+this._initialTransform:i}_getDragDistance(t){const e=this._pickupPositionOnPage;return e?{x:t.x-e.x,y:t.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:e}=this._passiveTransform;if(0===t&&0===e||this.isDragging()||!this._boundaryElement)return;const i=this._boundaryElement.getBoundingClientRect(),r=this._rootElement.getBoundingClientRect();if(0===i.width&&0===i.height||0===r.width&&0===r.height)return;const s=i.left-r.left,o=r.right-i.right,n=i.top-r.top,a=r.bottom-i.bottom;i.width>r.width?(s>0&&(t+=s),o>0&&(t-=o)):t=0,i.height>r.height?(n>0&&(e+=n),a>0&&(e-=a)):e=0,t===this._passiveTransform.x&&e===this._passiveTransform.y||this.setFreeDragPosition({y:e,x:t})}_getDragStartDelay(t){const e=this.dragStartDelay;return"number"==typeof e?e:_t(t)?e.touch:e?e.mouse:0}_updateOnScroll(t){const e=this._parentPositions.handleScroll(t);if(e){const i=t.target;this._boundaryRect&&(i===this._document||i!==this._boundaryElement&&i.contains(this._boundaryElement))&&st(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){const t=this._parentPositions.positions.get(this._document);return t?t.scrollPosition:this._viewportRuler.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=Object(U.c)(this._rootElement)),this._cachedShadowRoot}}function mt(t,e){return`translate3d(${Math.round(t)}px, ${Math.round(e)}px, 0)`}function pt(t,e,i){return Math.max(e,Math.min(i,t))}function ft(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function _t(t){return"t"===t.type[0]}function vt(t,e){const i=t.rootNodes;if(1===i.length&&i[0].nodeType===e.ELEMENT_NODE)return i[0];const r=e.createElement("div");return i.forEach(t=>r.appendChild(t)),r}function St(t,e){t.style.width=`${e.width}px`,t.style.height=`${e.height}px`,t.style.transform=mt(e.left,e.top)}function Ct(t,e,i){const r=Et(e,t.length-1),s=Et(i,t.length-1);if(r===s)return;const o=t[r],n=s<r?-1:1;for(let a=r;a!==s;a+=n)t[a]=t[a+n];t[s]=o}function Et(t,e){return Math.max(0,Math.min(e,t))}class Dt{constructor(t,e,i,r,s){this._dragDropRegistry=e,this._ngZone=r,this._viewportRuler=s,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new M.a,this.entered=new M.a,this.exited=new M.a,this.dropped=new M.a,this.sorted=new M.a,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0,overlaps:!1},this._draggables=[],this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=F.a.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new M.a,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function(t=0,e=z.a){return(!Object(q.a)(t)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=z.a),new j.a(i=>(i.add(e.schedule(J,t,{subscriber:i,counter:0,period:t})),i))}(0,G.a).pipe(Object(V.a)(this._stopScrollTimers)).subscribe(()=>{const t=this._scrollNode,e=this.autoScrollStep;1===this._verticalScrollDirection?Pt(t,-e):2===this._verticalScrollDirection&&Pt(t,e),1===this._horizontalScrollDirection?Tt(t,-e):2===this._horizontalScrollDirection&&Tt(t,e)})},this.element=Object(B.e)(t),this._document=i,this.withScrollableParents([this.element]),e.registerDropContainer(this),this._parentPositions=new nt(i,s)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(t,e,i,r){let s;this._draggingStarted(),null==r?(s=this.sortingDisabled?this._draggables.indexOf(t):-1,-1===s&&(s=this._getItemIndexFromPointerPosition(t,e,i))):s=r;const o=this._activeDraggables,n=o.indexOf(t),a=t.getPlaceholderElement();let c=o[s];if(c===t&&(c=o[s+1]),n>-1&&o.splice(n,1),c&&!this._dragDropRegistry.isDragging(c)){const e=c.getRootElement();e.parentElement.insertBefore(a,e),o.splice(s,0,t)}else if(this._shouldEnterAsFirstChild(e,i)){const e=o[0].getRootElement();e.parentNode.insertBefore(a,e),o.unshift(t)}else Object(B.e)(this.element).appendChild(a),o.push(t);a.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,e,i,r,s,o){this._reset(),this.dropped.next({item:t,currentIndex:e,previousIndex:i,container:this,previousContainer:r,isPointerOverContainer:s,distance:o})}withItems(t){const e=this._draggables;return this._draggables=t,t.forEach(t=>t._withDropContainer(this)),this.isDragging()&&(e.filter(t=>t.isDragging()).every(e=>-1===t.indexOf(e))?this._reset():this._cacheItems()),this}withDirection(t){return this._direction=t,this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){return this._orientation=t,this}withScrollableParents(t){const e=Object(B.e)(this.element);return this._scrollableElements=-1===t.indexOf(e)?[e,...t]:t.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?Rt("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,e=>e.drag===t):this._draggables.indexOf(t)}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,e,i,r){if(this.sortingDisabled||!this._clientRect||!ot(this._clientRect,.05,e,i))return;const s=this._itemPositions,o=this._getItemIndexFromPointerPosition(t,e,i,r);if(-1===o&&s.length>0)return;const n="horizontal"===this._orientation,a=Rt(s,e=>e.drag===t),c=s[o],l=c.clientRect,d=a>o?1:-1,h=this._getItemOffsetPx(s[a].clientRect,l,d),u=this._getSiblingOffsetPx(a,s,d),g=s.slice();Ct(s,a,o),this.sorted.next({previousIndex:a,currentIndex:o,container:this,item:t}),s.forEach((e,i)=>{if(g[i]===e)return;const r=e.drag===t,s=r?h:u,o=r?t.getPlaceholderElement():e.drag.getRootElement();e.offset+=s,n?(o.style.transform=`translate3d(${Math.round(e.offset)}px, 0, 0)`,st(e.clientRect,0,s)):(o.style.transform=`translate3d(0, ${Math.round(e.offset)}px, 0)`,st(e.clientRect,s,0))}),this._previousSwap.overlaps=rt(l,e,i),this._previousSwap.drag=c.drag,this._previousSwap.delta=n?r.x:r.y}_startScrollingIfNecessary(t,e){if(this.autoScrollDisabled)return;let i,r=0,s=0;if(this._parentPositions.positions.forEach((o,n)=>{n!==this._document&&o.clientRect&&!i&&ot(o.clientRect,.05,t,e)&&([r,s]=function(t,e,i,r){const s=wt(e,r),o=yt(e,i);let n=0,a=0;if(s){const e=t.scrollTop;1===s?e>0&&(n=1):t.scrollHeight-e>t.clientHeight&&(n=2)}if(o){const e=t.scrollLeft;1===o?e>0&&(a=1):t.scrollWidth-e>t.clientWidth&&(a=2)}return[n,a]}(n,o.clientRect,t,e),(r||s)&&(i=n))}),!r&&!s){const{width:o,height:n}=this._viewportRuler.getViewportSize(),a={width:o,height:n,top:0,right:o,bottom:n,left:0};r=wt(a,e),s=yt(a,t),i=window}!i||r===this._verticalScrollDirection&&s===this._horizontalScrollDirection&&i===this._scrollNode||(this._verticalScrollDirection=r,this._horizontalScrollDirection=s,this._scrollNode=i,(r||s)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const t=Object(B.e)(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._cacheItems(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const t=Object(B.e)(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(t).clientRect}_cacheItemPositions(){const t="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map(t=>{const e=t.getVisibleElement();return{drag:t,offset:0,clientRect:it(e)}}).sort((e,i)=>t?e.clientRect.left-i.clientRect.left:e.clientRect.top-i.clientRect.top)}_reset(){this._isDragging=!1;const t=Object(B.e)(this.element).style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach(t=>{const e=t.getRootElement();e&&(e.style.transform="")}),this._siblings.forEach(t=>t._stopReceiving(this)),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_getSiblingOffsetPx(t,e,i){const r="horizontal"===this._orientation,s=e[t].clientRect,o=e[t+-1*i];let n=s[r?"width":"height"]*i;if(o){const t=r?"left":"top",e=r?"right":"bottom";-1===i?n-=o.clientRect[t]-s[e]:n+=s[t]-o.clientRect[e]}return n}_getItemOffsetPx(t,e,i){const r="horizontal"===this._orientation;let s=r?e.left-t.left:e.top-t.top;return-1===i&&(s+=r?e.width-t.width:e.height-t.height),s}_shouldEnterAsFirstChild(t,e){if(!this._activeDraggables.length)return!1;const i=this._itemPositions,r="horizontal"===this._orientation;if(i[0].drag!==this._activeDraggables[0]){const s=i[i.length-1].clientRect;return r?t>=s.right:e>=s.bottom}{const s=i[0].clientRect;return r?t<=s.left:e<=s.top}}_getItemIndexFromPointerPosition(t,e,i,r){const s="horizontal"===this._orientation,o=Rt(this._itemPositions,({drag:o,clientRect:n},a,c)=>{if(o===t)return c.length<2;if(r){const t=s?r.x:r.y;if(o===this._previousSwap.drag&&this._previousSwap.overlaps&&t===this._previousSwap.delta)return!1}return s?e>=Math.floor(n.left)&&e<Math.floor(n.right):i>=Math.floor(n.top)&&i<Math.floor(n.bottom)});return-1!==o&&this.sortPredicate(o,t,this)?o:-1}_cacheItems(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}_isOverContainer(t,e){return null!=this._clientRect&&rt(this._clientRect,t,e)}_getSiblingContainerFromPosition(t,e,i){return this._siblings.find(r=>r._canReceive(t,e,i))}_canReceive(t,e,i){if(!this._clientRect||!rt(this._clientRect,e,i)||!this.enterPredicate(t,this))return!1;const r=this._getShadowRoot().elementFromPoint(e,i);if(!r)return!1;const s=Object(B.e)(this.element);return r===s||s.contains(r)}_startReceiving(t,e){const i=this._activeSiblings;!i.has(t)&&e.every(t=>this.enterPredicate(t,this)||this._draggables.indexOf(t)>-1)&&(i.add(t),this._cacheParentPositions(),this._listenToScrollEvents())}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe()}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scroll.subscribe(t=>{if(this.isDragging()){const e=this._parentPositions.handleScroll(t);e&&(this._itemPositions.forEach(({clientRect:t})=>{st(t,e.top,e.left)}),this._itemPositions.forEach(({drag:t})=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()}))}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const t=Object(U.c)(Object(B.e)(this.element));this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const t=this._activeDraggables.filter(t=>t.isDragging());this._siblings.forEach(e=>e._startReceiving(this,t))}}function Rt(t,e){for(let i=0;i<t.length;i++)if(e(t[i],i,t))return i;return-1}function Pt(t,e){t===window?t.scrollBy(0,e):t.scrollTop+=e}function Tt(t,e){t===window?t.scrollBy(e,0):t.scrollLeft+=e}function wt(t,e){const{top:i,bottom:r,height:s}=t,o=.05*s;return e>=i-o&&e<=i+o?1:e>=r-o&&e<=r+o?2:0}function yt(t,e){const{left:i,right:r,width:s}=t,o=.05*s;return e>=i-o&&e<=i+o?1:e>=r-o&&e<=r+o?2:0}const xt=Object(U.f)({passive:!1,capture:!0});let Ot=(()=>{class t{constructor(t,e){this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=t=>t.isDragging(),this.pointerMove=new M.a,this.pointerUp=new M.a,this.scroll=new M.a,this._preventDefaultWhileDragging=t=>{this._activeDragInstances.length>0&&t.preventDefault()},this._persistentTouchmoveListener=t=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&t.preventDefault(),this.pointerMove.next(t))},this._document=e}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,xt)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,xt)}startDragging(t,e){if(!(this._activeDragInstances.indexOf(t)>-1)&&(this._activeDragInstances.push(t),1===this._activeDragInstances.length)){const t=e.type.startsWith("touch");this._globalListeners.set(t?"touchend":"mouseup",{handler:t=>this.pointerUp.next(t),options:!0}).set("scroll",{handler:t=>this.scroll.next(t),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:xt}),t||this._globalListeners.set("mousemove",{handler:t=>this.pointerMove.next(t),options:xt}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((t,e)=>{this._document.addEventListener(e,t.handler,t.options)})})}}stopDragging(t){const e=this._activeDragInstances.indexOf(t);e>-1&&(this._activeDragInstances.splice(e,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(t){return this._activeDragInstances.indexOf(t)>-1}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,e)=>{this._document.removeEventListener(e,t.handler,t.options)}),this._globalListeners.clear()}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(d.B),d.Xb(r.d))},t.\u0275prov=Object(d.Jb)({factory:function(){return new t(Object(d.Xb)(d.B),Object(d.Xb)(r.d))},token:t,providedIn:"root"}),t})();const kt={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let At=(()=>{class t{constructor(t,e,i,r){this._document=t,this._ngZone=e,this._viewportRuler=i,this._dragDropRegistry=r}createDrag(t,e=kt){return new bt(t,e,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new Dt(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(r.d),d.Xb(d.B),d.Xb(L.e),d.Xb(Ot))},t.\u0275prov=Object(d.Jb)({factory:function(){return new t(Object(d.Xb)(r.d),Object(d.Xb)(d.B),Object(d.Xb)(L.e),Object(d.Xb)(Ot))},token:t,providedIn:"root"}),t})();const It=new d.s("CDK_DRAG_PARENT"),Nt=new d.s("CdkDropListGroup"),Lt=new d.s("CDK_DRAG_CONFIG");let Ut=0;const Bt=new d.s("CdkDropList");let Mt=(()=>{class t{constructor(e,i,r,s,o,n,a){this.element=e,this._changeDetectorRef=r,this._scrollDispatcher=s,this._dir=o,this._group=n,this._destroyed=new M.a,this.connectedTo=[],this.id="cdk-drop-list-"+Ut++,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.dropped=new d.o,this.entered=new d.o,this.exited=new d.o,this.sorted=new d.o,this._unsortedItems=new Set,this._dropListRef=i.createDropList(e),this._dropListRef.data=this,a&&this._assignDefaults(a),this._dropListRef.enterPredicate=(t,e)=>this.enterPredicate(t.data,e.data),this._dropListRef.sortPredicate=(t,e,i)=>this.sortPredicate(t,e.data,i.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),t._dropLists.push(this),n&&n._items.add(this)}get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(t){this._dropListRef.disabled=this._disabled=Object(B.c)(t)}addItem(t){this._unsortedItems.add(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(t){this._unsortedItems.delete(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((t,e)=>t._dragRef.getVisibleElement().compareDocumentPosition(e._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const e=t._dropLists.indexOf(this);e>-1&&t._dropLists.splice(e,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(e){this._dir&&this._dir.change.pipe(Object(c.a)(this._dir.value),Object(V.a)(this._destroyed)).subscribe(t=>e.withDirection(t)),e.beforeStarted.subscribe(()=>{const i=Object(B.b)(this.connectedTo).map(e=>"string"==typeof e?t._dropLists.find(t=>t.id===e):e);if(this._group&&this._group._items.forEach(t=>{-1===i.indexOf(t)&&i.push(t)}),!this._scrollableParentsResolved){const t=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(t=>t.getElementRef().nativeElement);this._dropListRef.withScrollableParents(t),this._scrollableParentsResolved=!0}e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.sortingDisabled=Object(B.c)(this.sortingDisabled),e.autoScrollDisabled=Object(B.c)(this.autoScrollDisabled),e.autoScrollStep=Object(B.f)(this.autoScrollStep,2),e.connectedTo(i.filter(t=>t&&t!==this).map(t=>t._dropListRef)).withOrientation(this.orientation)})}_handleEvents(t){t.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(t=>{this.entered.emit({container:this,item:t.item.data,currentIndex:t.currentIndex})}),t.exited.subscribe(t=>{this.exited.emit({container:this,item:t.item.data}),this._changeDetectorRef.markForCheck()}),t.sorted.subscribe(t=>{this.sorted.emit({previousIndex:t.previousIndex,currentIndex:t.currentIndex,container:this,item:t.item.data})}),t.dropped.subscribe(t=>{this.dropped.emit({previousIndex:t.previousIndex,currentIndex:t.currentIndex,previousContainer:t.previousContainer.data,container:t.container.data,item:t.item.data,isPointerOverContainer:t.isPointerOverContainer,distance:t.distance}),this._changeDetectorRef.markForCheck()})}_assignDefaults(t){const{lockAxis:e,draggingDisabled:i,sortingDisabled:r,listAutoScrollDisabled:s,listOrientation:o}=t;this.disabled=null!=i&&i,this.sortingDisabled=null!=r&&r,this.autoScrollDisabled=null!=s&&s,this.orientation=o||"vertical",e&&(this.lockAxis=e)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(t=>t._dragRef))}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(d.l),d.Nb(At),d.Nb(d.h),d.Nb(L.c),d.Nb(W.b,8),d.Nb(Nt,12),d.Nb(Lt,8))},t.\u0275dir=d.Ib({type:t,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(t,e){2&t&&(d.Db("id",e.id),d.Fb("cdk-drop-list-disabled",e.disabled)("cdk-drop-list-dragging",e._dropListRef.isDragging())("cdk-drop-list-receiving",e._dropListRef.isReceiving()))},inputs:{connectedTo:["cdkDropListConnectedTo","connectedTo"],id:"id",enterPredicate:["cdkDropListEnterPredicate","enterPredicate"],sortPredicate:["cdkDropListSortPredicate","sortPredicate"],disabled:["cdkDropListDisabled","disabled"],sortingDisabled:["cdkDropListSortingDisabled","sortingDisabled"],autoScrollDisabled:["cdkDropListAutoScrollDisabled","autoScrollDisabled"],orientation:["cdkDropListOrientation","orientation"],lockAxis:["cdkDropListLockAxis","lockAxis"],data:["cdkDropListData","data"],autoScrollStep:["cdkDropListAutoScrollStep","autoScrollStep"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[d.Bb([{provide:Nt,useValue:void 0},{provide:Bt,useExisting:t}])]}),t._dropLists=[],t})();const Ft=new d.s("CdkDragHandle"),jt=new d.s("CdkDragPlaceholder");let zt=(()=>{class t{constructor(t){this.templateRef=t}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(d.N))},t.\u0275dir=d.Ib({type:t,selectors:[["ng-template","cdkDragPlaceholder",""]],inputs:{data:"data"},features:[d.Bb([{provide:jt,useExisting:t}])]}),t})();const qt=new d.s("CdkDragPreview");let Jt=(()=>{class t{constructor(e,i,r,s,o,n,a,c,h,u,g){this.element=e,this.dropContainer=i,this._ngZone=s,this._viewContainerRef=o,this._dir=a,this._changeDetectorRef=h,this._selfHandle=u,this._parentDrag=g,this._destroyed=new M.a,this.started=new d.o,this.released=new d.o,this.ended=new d.o,this.entered=new d.o,this.exited=new d.o,this.dropped=new d.o,this.moved=new j.a(t=>{const e=this._dragRef.moved.pipe(Object(l.a)(t=>({source:this,pointerPosition:t.pointerPosition,event:t.event,delta:t.delta,distance:t.distance}))).subscribe(t);return()=>{e.unsubscribe()}}),this._dragRef=c.createDrag(e,{dragStartThreshold:n&&null!=n.dragStartThreshold?n.dragStartThreshold:5,pointerDirectionChangeThreshold:n&&null!=n.pointerDirectionChangeThreshold?n.pointerDirectionChangeThreshold:5,zIndex:null==n?void 0:n.zIndex}),this._dragRef.data=this,t._dragInstances.push(this),n&&this._assignDefaults(n),i&&(this._dragRef._withDropContainer(i._dropListRef),i.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(t){this._disabled=Object(B.c)(t),this._dragRef.disabled=this._disabled}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}ngAfterViewInit(){this._ngZone.onStable.pipe(Object($.a)(1),Object(V.a)(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._handles.changes.pipe(Object(c.a)(this._handles),Object(Q.a)(t=>{const e=t.filter(t=>t._parentDrag===this).map(t=>t.element);this._selfHandle&&this.rootElementSelector&&e.push(this.element),this._dragRef.withHandles(e)}),Object(X.a)(t=>Object(H.a)(...t.map(t=>t._stateChanges.pipe(Object(c.a)(t))))),Object(V.a)(this._destroyed)).subscribe(t=>{const e=this._dragRef,i=t.element.nativeElement;t.disabled?e.disableHandle(i):e.enableHandle(i)}),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})}ngOnChanges(t){const e=t.rootElementSelector,i=t.freeDragPosition;e&&!e.firstChange&&this._updateRootElement(),i&&!i.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);const e=t._dragInstances.indexOf(this);e>-1&&t._dragInstances.splice(e,1),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()}_updateRootElement(){const t=this.element.nativeElement,e=this.rootElementSelector?Gt(t,this.rootElementSelector):t;this._dragRef.withRootElement(e||t)}_getBoundaryElement(){const t=this.boundaryElement;return t?"string"==typeof t?Gt(this.element.nativeElement,t):Object(B.e)(t):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){const t=this._dir,i=this.dragStartDelay,r=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,s=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.dragStartDelay="object"==typeof i&&i?i:Object(B.f)(i),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(r).withPreviewTemplate(s),t&&e.withDirection(t.value)}}),e.beforeStarted.pipe(Object($.a)(1)).subscribe(()=>{var i,r;if(this._parentDrag)return void e.withParent(this._parentDrag._dragRef);let s=this.element.nativeElement.parentElement;for(;s;){if(null===(i=s.classList)||void 0===i?void 0:i.contains("cdk-drag")){e.withParent((null===(r=t._dragInstances.find(t=>t.element.nativeElement===s))||void 0===r?void 0:r._dragRef)||null);break}s=s.parentElement}})}_handleEvents(t){t.started.subscribe(()=>{this.started.emit({source:this}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(()=>{this.released.emit({source:this})}),t.ended.subscribe(t=>{this.ended.emit({source:this,distance:t.distance}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(t=>{this.entered.emit({container:t.container.data,item:this,currentIndex:t.currentIndex})}),t.exited.subscribe(t=>{this.exited.emit({container:t.container.data,item:this})}),t.dropped.subscribe(t=>{this.dropped.emit({previousIndex:t.previousIndex,currentIndex:t.currentIndex,previousContainer:t.previousContainer.data,container:t.container.data,isPointerOverContainer:t.isPointerOverContainer,item:this,distance:t.distance})})}_assignDefaults(t){const{lockAxis:e,dragStartDelay:i,constrainPosition:r,previewClass:s,boundaryElement:o,draggingDisabled:n,rootElementSelector:a}=t;this.disabled=null!=n&&n,this.dragStartDelay=i||0,e&&(this.lockAxis=e),r&&(this.constrainPosition=r),s&&(this.previewClass=s),o&&(this.boundaryElement=o),a&&(this.rootElementSelector=a)}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(d.l),d.Nb(Bt,12),d.Nb(r.d),d.Nb(d.B),d.Nb(d.R),d.Nb(Lt,8),d.Nb(W.b,8),d.Nb(At),d.Nb(d.h),d.Nb(Ft,10),d.Nb(It,12))},t.\u0275dir=d.Ib({type:t,selectors:[["","cdkDrag",""]],contentQueries:function(t,e,i){if(1&t&&(d.Gb(i,qt,1),d.Gb(i,jt,1),d.Gb(i,Ft,1)),2&t){let t;d.qc(t=d.bc())&&(e._previewTemplate=t.first),d.qc(t=d.bc())&&(e._placeholderTemplate=t.first),d.qc(t=d.bc())&&(e._handles=t)}},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(t,e){2&t&&d.Fb("cdk-drag-disabled",e.disabled)("cdk-drag-dragging",e._dragRef.isDragging())},inputs:{disabled:["cdkDragDisabled","disabled"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],lockAxis:["cdkDragLockAxis","lockAxis"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],boundaryElement:["cdkDragBoundary","boundaryElement"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],data:["cdkDragData","data"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[d.Bb([{provide:It,useExisting:t}]),d.Ab]}),t._dragInstances=[],t})();function Gt(t,e){let i=t.parentElement;for(;i;){if(i.matches?i.matches(e):i.msMatchesSelector(e))return i;i=i.parentElement}return null}let Ht=(()=>{class t{}return t.\u0275mod=d.Lb({type:t}),t.\u0275inj=d.Kb({factory:function(e){return new(e||t)},providers:[At],imports:[L.b]}),t})();var Vt=i("1jcm");function $t(t,e){if(1&t&&(d.Tb(0,"mat-option",9),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.kc("value",t),d.Cb(1),d.Dc(" ",t.nombre," ")}}function Qt(t,e){if(1&t){const t=d.Ub();d.Tb(0,"button",10),d.ac("click",function(){d.tc(t);const e=d.ec();return e.agregarRolEstrategia(e.selectedRol)}),d.Bc(1,"Agregar"),d.Sb()}}function Xt(t,e){1&t&&d.Ob(0,"div",14)}function Wt(t,e){if(1&t){const t=d.Ub();d.Tb(0,"div",11),d.Ac(1,Xt,1,0,"div",12),d.Tb(2,"div"),d.Bc(3),d.Sb(),d.Tb(4,"div"),d.Tb(5,"mat-slide-toggle",13),d.ac("ngModelChange",function(t){return e.$implicit.activo=t})("ngModelChange",function(){return d.tc(t),d.ec().actualizarActivoDeEstrategiaRol()}),d.Sb(),d.Sb(),d.Sb()}if(2&t){const t=e.$implicit;d.Cb(3),d.Ec("",t.orden,".",t.rol.nombre,""),d.Cb(2),d.kc("ngModel",t.activo)}}function Zt(t,e){1&t&&d.Ob(0,"mat-spinner",15)}function Yt(t,e){if(1&t){const t=d.Ub();d.Tb(0,"button",16),d.ac("click",function(){return d.tc(t),d.ec().grabarCambios()}),d.Bc(1,"Grabar Cambios"),d.Sb()}}let Kt=(()=>{class t{constructor(t,e,i){this.dialogRef=t,this.data=e,this.rolEstrategiaService=i,this.listadoRoles=[],this.listadoRolesxEstrategia=[],this.carga=!1,this.btnGrabarVisible=!1,this.btnAgregarVisible=!0,this.ordenId=0,t.disableClose=!0,this.getListarRoles(),this.getListarRolesAsignadosxEstrategia()}ngOnInit(){this.btnGrabarVisible=!1}getListarRoles(){return Object(o.a)(this,void 0,void 0,function*(){this.listadoRoles=yield this.rolEstrategiaService.getListarRolesQueFaltanEnEstrategia(this.data)})}getListarRolesAsignadosxEstrategia(){return Object(o.a)(this,void 0,void 0,function*(){this.listadoRolesxEstrategia=yield this.rolEstrategiaService.getListarRolesAsignadosxEstrategia(this.data)})}drop(t){this.btnGrabarVisible=!0,Ct(this.listadoRolesxEstrategia,t.previousIndex,t.currentIndex)}agregarRolEstrategia(t){this.ordenId=this.listadoRolesxEstrategia.length+1,this.rolEstrategiaService.crearRolEstrategia({orden:this.ordenId,estrategia:this.data,rol:t}).then(t=>{this.getListarRoles(),this.getListarRolesAsignadosxEstrategia()})}grabarCambios(){return Object(o.a)(this,void 0,void 0,function*(){this.btnGrabarVisible=!1;let t={};t=yield this.mapRoles(),this.rolEstrategiaService.actualizarListadoRolAsignadoxEstrategia(t).then(t=>{this.getListarRoles(),this.getListarRolesAsignadosxEstrategia()})})}mapRoles(){return Object(o.a)(this,void 0,void 0,function*(){let t=0,e=[],i=[];return this.listadoRolesxEstrategia.forEach(r=>{r.activo?(t++,e.push({id:r.id,orden:t,rol:r.rol,activo:r.activo})):i.push({id:r.id,orden:null,rol:r.rol,activo:r.activo})}),i.forEach(t=>{e.push(t)}),{id_estrategia:this.data.id,lista:e}})}actualizarActivoDeEstrategiaRol(){return Object(o.a)(this,void 0,void 0,function*(){this.grabarCambios()})}onNoClick(){this.btnGrabarVisible=!1,this.dialogRef.close(this.listadoRolesxEstrategia)}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(n.d),d.Nb(n.a),d.Nb(u))},t.\u0275cmp=d.Hb({type:t,selectors:[["app-asignar-roles"]],decls:15,vars:6,consts:[["appearance","fill"],["name","rol",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-button","",3,"click",4,"ngIf"],["cdkDropList","",1,"example-list",3,"cdkDropListDropped"],["class","example-box","cdkDrag","",4,"ngFor","ngForOf"],["class","spinner","diameter","40","color","accent","strokeWidth","7",4,"ngIf"],["mat-button","","color","accent","cdkFocusInitial","",3,"click",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"],[3,"value"],["mat-button","",3,"click"],["cdkDrag","",1,"example-box"],["class","example-custom-placeholder",4,"cdkDragPlaceholder"],[3,"ngModel","ngModelChange"],[1,"example-custom-placeholder"],["diameter","40","color","accent","strokeWidth","7",1,"spinner"],["mat-button","","color","accent","cdkFocusInitial","",3,"click"]],template:function(t,e){1&t&&(d.Tb(0,"mat-form-field",0),d.Tb(1,"mat-label"),d.Bc(2,"Seleccionar Rol"),d.Sb(),d.Tb(3,"mat-select",1),d.ac("ngModelChange",function(t){return e.selectedRol=t}),d.Ac(4,$t,2,2,"mat-option",2),d.Sb(),d.Sb(),d.Tb(5,"div"),d.Ac(6,Qt,2,0,"button",3),d.Sb(),d.Ob(7,"br"),d.Tb(8,"div",4),d.ac("cdkDropListDropped",function(t){return e.drop(t)}),d.Ac(9,Wt,6,3,"div",5),d.Sb(),d.Ob(10,"br"),d.Ac(11,Zt,1,0,"mat-spinner",6),d.Ac(12,Yt,2,0,"button",7),d.Tb(13,"button",8),d.ac("click",function(){return e.onNoClick()}),d.Bc(14,"Cerrar Ventana"),d.Sb()),2&t&&(d.Cb(3),d.kc("ngModel",e.selectedRol),d.Cb(1),d.kc("ngForOf",e.listadoRoles),d.Cb(2),d.kc("ngIf",e.btnAgregarVisible),d.Cb(3),d.kc("ngForOf",e.listadoRolesxEstrategia),d.Cb(2),d.kc("ngIf",e.carga),d.Cb(1),d.kc("ngIf",e.btnGrabarVisible))},directives:[b.c,b.g,m.a,a.o,a.r,r.l,r.m,Mt,_.a,S.l,Jt,zt,Vt.a,E.b],styles:[".example-list[_ngcontent-%COMP%]{width:500px;max-width:100%;border:1px solid #ccc;min-height:60px;display:block;background:#fff;border-radius:4px;overflow:hidden}.example-box[_ngcontent-%COMP%]{padding:20px 10px;border-bottom:1px solid #ccc;color:rgba(0,0,0,.87);display:flex;flex-direction:row;align-items:center;justify-content:space-between;box-sizing:border-box;cursor:move;background:#fff;font-size:14px}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.example-custom-placeholder[_ngcontent-%COMP%], .example-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .example-box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.example-custom-placeholder[_ngcontent-%COMP%]{background:#ccc;border:3px dotted #999;min-height:60px}.spinner[_ngcontent-%COMP%]{position:relative;display:block;margin-left:448px;margin-bottom:10px}"]}),t})();var te=i("Xksa"),ee=i("dNgK"),ie=i("bUJT");let re=(()=>{class t{constructor(t){this.resourceService=t}crearEstrategia(t){var e,i;console.log("adding estrategia..."+JSON.stringify(t));let r={id_escenario_nivel3:null===(e=t.escenario_nivel3)||void 0===e?void 0:e.id,id_tipo_solicitud:null===(i=t.tipo_solicitud)||void 0===i?void 0:i.id};return console.log("sending estrategia..."+JSON.stringify(r)),new Promise((t,e)=>{this.resourceService.postResource("/estrategia/crear",r).toPromise().then(e=>{console.log("response data="+JSON.stringify(e)),t(e)}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),e(t)})})}getListarEstrategias(t){let e=[],i={},r=null,s=null,o=null,n=null,a=null;return t.id_sociedad&&(r=t.id_sociedad),t.id_escenario_nivel1&&(s=t.id_escenario_nivel1),t.id_escenario_nivel2&&(o=t.id_escenario_nivel2),t.id_escenario_nivel3&&(n=t.id_escenario_nivel3),t.id_tipo_solicitud&&(a=t.id_tipo_solicitud),i={id_sociedad:r,id_escenario_nivel1:s,id_escenario_nivel2:o,id_escenario_nivel3:n,id_tipo_solicitud:a},new Promise((t,r)=>{this.resourceService.postResource("/estrategia/listarPorFiltros",i).toPromise().then(i=>{let r;i&&0!==Object.keys(i).length?(r=i.lista,r.forEach(t=>{e.push({id:t.id,escenario_nivel3:t.escenario_nivel3,tipo_solicitud:t.tipo_solicitud})}),t(e)):(console.log("no sociedaes encontradas..."),t([]))}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),r(t)})})}getListarCorreoEstrategia(t){let e=[],i=parseInt(t);return new Promise((t,r)=>{this.resourceService.getResource("/estrategia/listarEstrategiaCorreo?id_estrategia="+i).toPromise().then(i=>{1==i.resultado?(e=i.lista,t(e)):(console.log("no correos encontrados..."),t([]))}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),r(t)})})}addCorreoEstrategia(t){let e,i={correo:t.correo,id_estrategia:parseInt(t.id_estrategia)};return console.log("sending data : "+JSON.stringify(i)),new Promise((t,r)=>{this.resourceService.postResource("/estrategia/crearEstrategiaCorreo",i).toPromise().then(i=>{e=i,t(e)}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),r(t)})})}borrarCorreoEstrategia(t){let e,i={id:parseInt(t)};return new Promise((t,r)=>{this.resourceService.postResource("/estrategia/eliminarPorId",i).toPromise().then(i=>{e=i,t(e)}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),r(t)})})}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(h.a))},t.\u0275prov=d.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var se=i("zkoq");function oe(t,e){1&t&&(d.Tb(0,"th",20),d.Bc(1," Correo"),d.Sb())}function ne(t,e){if(1&t&&(d.Tb(0,"td",21),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.Cb(1),d.Dc(" ",t.correo," ")}}function ae(t,e){1&t&&(d.Tb(0,"th",20),d.Bc(1," Acciones "),d.Sb())}function ce(t,e){if(1&t){const t=d.Ub();d.Tb(0,"td",21),d.Tb(1,"button",22),d.ac("click",function(){d.tc(t);const i=e.$implicit;return d.ec().eliminarCorreo(i)}),d.Tb(2,"mat-icon"),d.Bc(3,"delete"),d.Sb(),d.Sb(),d.Sb()}}function le(t,e){1&t&&d.Ob(0,"tr",23)}function de(t,e){1&t&&d.Ob(0,"tr",24)}let he=(()=>{class t{constructor(t,e,i,r,s,o){this.dialogRef=t,this.data=e,this.formBuilder=i,this._snack=r,this.formValidatorService=s,this.estrategiaService=o,this.listadoCorreosEstrategia=[],this.displayedColumns=["correo","acciones"],this.formErrors={correo:""},this.validationMessages={correo:{required:"el correo es requerido."}},this.submitted=!1,this.FAKE_DATA=[{id:1,correo:"correo1@gmail.com"},{id:2,correo:"correo2@gmail.com"},{id:3,correo:"correo3@gmail.com"}],this.MENSAJE_CREAR_CORREO_ESTRATEGIA=te.a.confirmation.MENSAJE_CREAR_CORREO_ESTRATEGIA,this.MENSAJE_ELIMINAR_CORREO_ESTRATEGIA=te.a.confirmation.MENSAJE_ELIMINAR_CORREO_ESTRATEGIA,this.id_estrategia=e.id_estrategia,this.dialogForm=this.formBuilder.group({correo:[""]}),this.dialogForm.valueChanges.subscribe(()=>{this.formErrors=this.formValidatorService.handleFormChanges(this.dialogForm,this.formErrors,this.validationMessages,this.submitted)})}ngOnInit(){this.getListaCorreos(this.id_estrategia)}getListaCorreos(t){this.estrategiaService.getListarCorreoEstrategia(t).then(t=>{this.listadoCorreosEstrategia=t,console.log("el listado es : "+JSON.stringify(this.listadoCorreosEstrategia))})}grabarCorreo(t){console.log("capturing correo : "+JSON.stringify(t)),this.estrategiaService.addCorreoEstrategia({correo:t.correo,id_estrategia:this.id_estrategia}).then(t=>{1==t.resultado&&(this._snack.open(this.MENSAJE_CREAR_CORREO_ESTRATEGIA,"cerrar",{duration:1800,horizontalPosition:"end",verticalPosition:"top"}),this.getListaCorreos(this.id_estrategia))}).catch(t=>{console.debug("errors when trying to add Document....")})}eliminarCorreo(t){this.estrategiaService.borrarCorreoEstrategia(t.id).then(t=>{1==t.resultado&&(this._snack.open(this.MENSAJE_ELIMINAR_CORREO_ESTRATEGIA,"cerrar",{duration:1800,horizontalPosition:"end",verticalPosition:"top"}),this.getListaCorreos(this.id_estrategia))})}cerrarDialog(t){this.dialogRef.close(t)}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(n.d),d.Nb(n.a),d.Nb(a.d),d.Nb(ee.a),d.Nb(ie.a),d.Nb(re))},t.\u0275cmp=d.Hb({type:t,selectors:[["app-asignar-correos"]],decls:32,vars:7,consts:[[1,"contentDialog"],[3,"formGroup","ngSubmit"],["cols","3","rowHeight","75px"],["colspan","1"],[1,"izquierda"],["appearance","outline"],["matInput","","placeholder","correo","formControlName","correo","required",""],[3,"hidden"],["colspan","2"],["mat-raised-button","","color","accent","type","submit",3,"disabled"],[1,"content-table"],["mat-table","",1,"at-elevation-z8",3,"dataSource"],["matColumnDef","correo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"dialogButton"],["mat-raised-button","","color","default","type","button",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","accent",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(d.Tb(0,"h2"),d.Bc(1,"Asignar Correos Estrategia "),d.Sb(),d.Tb(2,"div",0),d.Tb(3,"form",1),d.ac("ngSubmit",function(){return e.grabarCorreo(e.dialogForm.value)}),d.Tb(4,"mat-grid-list",2),d.Tb(5,"mat-grid-tile",3),d.Tb(6,"div",4),d.Tb(7,"mat-form-field",5),d.Tb(8,"mat-label"),d.Bc(9,"Correo"),d.Sb(),d.Ob(10,"input",6),d.Tb(11,"mat-hint"),d.Tb(12,"mat-error",7),d.Bc(13),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(14,"mat-grid-tile",8),d.Tb(15,"div",4),d.Tb(16,"button",9),d.Bc(17,"Agregar "),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(18,"div",10),d.Tb(19,"table",11),d.Rb(20,12),d.Ac(21,oe,2,0,"th",13),d.Ac(22,ne,2,1,"td",14),d.Qb(),d.Rb(23,15),d.Ac(24,ae,2,0,"th",13),d.Ac(25,ce,4,0,"td",14),d.Qb(),d.Ac(26,le,1,0,"tr",16),d.Ac(27,de,1,0,"tr",17),d.Sb(),d.Sb(),d.Ob(28,"br"),d.Tb(29,"div",18),d.Tb(30,"button",19),d.ac("click",function(){return e.cerrarDialog("CONFIRM_DLG_NO")}),d.Bc(31,"Cerrar Ventana"),d.Sb(),d.Sb(),d.Sb()),2&t&&(d.Cb(3),d.kc("formGroup",e.dialogForm),d.Cb(9),d.kc("hidden",!e.formErrors.correo),d.Cb(1),d.Dc(" ",e.formErrors.correo," "),d.Cb(3),d.kc("disabled",e.dialogForm.invalid),d.Cb(3),d.kc("dataSource",e.listadoCorreosEstrategia),d.Cb(7),d.kc("matHeaderRowDef",e.displayedColumns),d.Cb(1),d.kc("matRowDefColumns",e.displayedColumns))},directives:[a.w,a.p,a.h,se.a,se.c,b.c,b.g,p.b,a.c,a.o,a.g,a.u,b.f,b.b,_.a,v.j,v.c,v.e,v.b,v.g,v.i,v.d,v.a,C.a,v.f,v.h],styles:[".contentDialog[_ngcontent-%COMP%]{display:block;min-width:600px;padding:20px 10px 15px}.content-table[_ngcontent-%COMP%]{position:relative;display:block;min-width:600px;padding-left:5px;padding-right:5px;padding-top:10px}.dialogButton[_ngcontent-%COMP%]{top:20px;position:relative}"]}),t})();var ue=i("B21Q");let ge=(()=>{class t{constructor(t){this.resourceService=t}getListarNivel1(t){let e=[];return new Promise((i,r)=>{this.resourceService.getResource("/maestro/escenarioNivel1/listarPorIdSociedad?id_sociedad="+t.id).toPromise().then(t=>{let r;t&&0!==Object.keys(t).length?(r=t.lista,r.forEach(t=>{console.log("Nivel1 encontradas..."+JSON.stringify(t)),e.push({id:t.id,codigo:t.codigo,nombre:t.nombre,sociedad:t.sociedad})}),i(e)):(console.log("no Nivel1 encontradas..."),i([]))}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),r(t)})})}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(h.a))},t.\u0275prov=d.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),be=(()=>{class t{constructor(t){this.resourceService=t}getListarNivel2(t){let e=[];return new Promise((i,r)=>{this.resourceService.getResource("/maestro/escenarioNivel2/listarPorIdEscenarioNivel1?id_escenario_nivel1="+t.id).toPromise().then(t=>{let r;t&&0!==Object.keys(t).length?(r=t.lista,r.forEach(t=>{console.log("Nivel1 encontradas..."+JSON.stringify(t)),e.push({id:t.id,codigo:t.codigo,nombre:t.nombre,nivel1:t.escenario_nivel1})}),i(e)):(console.log("no Nivel1 encontradas..."),i([]))}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),r(t)})})}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(h.a))},t.\u0275prov=d.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var me=i("0X3v");let pe=(()=>{class t{constructor(t){this.resourceService=t}getListarTipoSolicitud(){let t=[];return new Promise((e,i)=>{this.resourceService.getResource("/maestro/tipoSolicitud/listarTodo").toPromise().then(i=>{let r;i&&0!==Object.keys(i).length?(r=i.lista,r.forEach(e=>{console.log("sociedades encontradas..."+JSON.stringify(e)),t.push({id:e.id,nombre:e.nombre})}),e(t)):(console.log("no sociedaes encontradas..."),e([]))}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),i(t)})})}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(h.a))},t.\u0275prov=d.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function fe(t,e){if(1&t&&(d.Tb(0,"mat-option",29),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.kc("value",t),d.Cb(1),d.Dc(" ",t.codigo_sap," ")}}function _e(t,e){if(1&t&&(d.Tb(0,"mat-option",29),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.kc("value",t),d.Cb(1),d.Dc(" ",t.nombre," ")}}function ve(t,e){if(1&t&&(d.Tb(0,"mat-option",29),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.kc("value",t),d.Cb(1),d.Dc("",t.nombre," ")}}function Se(t,e){if(1&t&&(d.Tb(0,"mat-option",29),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.kc("value",t),d.Cb(1),d.Dc("",t.nombre," ")}}function Ce(t,e){if(1&t&&(d.Tb(0,"mat-option",29),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.kc("value",t),d.Cb(1),d.Cc(t.nombre)}}function Ee(t,e){1&t&&(d.Tb(0,"th",30),d.Bc(1," Sociedad"),d.Sb())}function De(t,e){if(1&t&&(d.Tb(0,"td",31),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.Cb(1),d.Dc(" ",t.escenario_nivel3.escenario_nivel2.escenario_nivel1.sociedad.codigo_sap," ")}}function Re(t,e){1&t&&(d.Tb(0,"th",30),d.Bc(1," Escenario Nivel 1"),d.Sb())}function Pe(t,e){if(1&t&&(d.Tb(0,"td",31),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.Cb(1),d.Dc(" ",t.escenario_nivel3.escenario_nivel2.escenario_nivel1.nombre," ")}}function Te(t,e){1&t&&(d.Tb(0,"th",30),d.Bc(1," Escenario Nivel 2 "),d.Sb())}function we(t,e){if(1&t&&(d.Tb(0,"td",31),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.Cb(1),d.Dc(" ",t.escenario_nivel3.escenario_nivel2.nombre," ")}}function ye(t,e){1&t&&(d.Tb(0,"th",30),d.Bc(1," Linea de Negocio "),d.Sb())}function xe(t,e){if(1&t&&(d.Tb(0,"td",31),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.Cb(1),d.Dc(" ",t.escenario_nivel3.nombre," ")}}function Oe(t,e){1&t&&(d.Tb(0,"th",30),d.Bc(1," Tipo Solicitud "),d.Sb())}function ke(t,e){if(1&t&&(d.Tb(0,"td",31),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.Cb(1),d.Dc(" ",t.tipo_solicitud.nombre," ")}}function Ae(t,e){1&t&&(d.Tb(0,"th",30),d.Bc(1," Acciones "),d.Sb())}function Ie(t,e){if(1&t){const t=d.Ub();d.Tb(0,"td",31),d.Tb(1,"button",32,33),d.ac("click",function(){d.tc(t);const i=e.$implicit;return d.ec().openDialogAsignarRoles(i)}),d.Bc(3," Asignar Roles "),d.Sb(),d.Bc(4," \xa0 "),d.Tb(5,"button",32,34),d.ac("click",function(){d.tc(t);const i=e.$implicit;return d.ec().openDialogAsignarUsuarios(i)}),d.Bc(7," Asignar Usuarios "),d.Sb(),d.Bc(8," \xa0 "),d.Tb(9,"button",32),d.ac("click",function(){d.tc(t);const i=e.$implicit;return d.ec().openDialogEquivalencias(i)}),d.Bc(10," Asignar Correo "),d.Sb(),d.Sb()}}function Ne(t,e){1&t&&d.Ob(0,"tr",35)}function Le(t,e){1&t&&d.Ob(0,"tr",36)}let Ue=(()=>{class t{constructor(t,e,i,r,s,o,n,c,l,d,h){this.router=t,this._snack=e,this.formBuilder=i,this.sociedadService=r,this.nivel1Service=s,this.nivel2Service=o,this.nivel3Service=n,this.tipoSolicitudService=c,this.estrategiaService=l,this.formValidatorService=d,this.matDialog=h,this.listadoSociedades=[],this.listadoNivel1=[],this.listadoNivel2=[],this.listadoNivel3=[],this.listadoTipoSolicitud=[],this.listadoEstrategias=[],this.displayedColumns=["sociedad","escenario_1","escenario_2","linea_negocio","tipo_solicitud","id_estrategia"],this.formErrors={sociedad:"",nivel1:"",nivel2:"",nivel3:"",tipoSolicitud:""},this.validationMessages={sociedad:{required:"Sociedad es requerido."},nivel1:{required:"nivel1 es requerida."},nivel2:{required:"nivel2 es requerida."},nivel3:{required:"nivel3 es requerida."},tipoSolicitud:{required:"tipoSolicitud es requerida."}},this.submitted=!1,this.btnAsignarUsuarioDisabled=!0,this.MENSAJE_REGISTRAR_ESTRATEGIA=te.a.confirmation.MENSAJE_REGISTRAR_ESTRATEGIA,this.filtroForm=this.formBuilder.group({sociedad:["",a.v.required],nivel1:["",a.v.required],nivel2:["",a.v.required],nivel3:["",a.v.required],tipoSolicitud:["",a.v.required]}),this.filtroForm.valueChanges.subscribe(()=>{this.formErrors=this.formValidatorService.handleFormChanges(this.filtroForm,this.formErrors,this.validationMessages,this.submitted)})}ngOnInit(){this.getListarSociedades(),this.getListarTipoSolicitud()}getListarSociedades(){return Object(o.a)(this,void 0,void 0,function*(){this.listadoSociedades=yield this.sociedadService.getListarSociedades()})}getListarTipoSolicitud(){return Object(o.a)(this,void 0,void 0,function*(){this.listadoTipoSolicitud=yield this.tipoSolicitudService.getListarTipoSolicitud()})}filtrarNivel1(){return Object(o.a)(this,void 0,void 0,function*(){this.listadoNivel1=[],this.listadoNivel2=[],this.listadoNivel3=[];let t=this.filtroForm.get("sociedad").value,e=this.filtroForm.get("tipoSolicitud").value;console.log(t),this.listadoNivel1=yield this.nivel1Service.getListarNivel1(t),this.getListarEstrategias({id_sociedad:t.id,id_tipo_solicitud:e?e.id:null})})}filtrarNivel2(){return Object(o.a)(this,void 0,void 0,function*(){this.listadoNivel2=[],this.listadoNivel3=[];let t=this.filtroForm.get("nivel1").value,e=this.filtroForm.get("tipoSolicitud").value;console.log(t),this.listadoNivel2=yield this.nivel2Service.getListarNivel2(t),this.getListarEstrategias({id_escenario_nivel1:t.id,id_tipo_solicitud:e?e.id:null})})}filtrarNivel3(){return Object(o.a)(this,void 0,void 0,function*(){this.listadoNivel3=[];let t=this.filtroForm.get("nivel2").value,e=this.filtroForm.get("tipoSolicitud").value;console.log(t),this.listadoNivel3=yield this.nivel3Service.getListarNivel3(t),this.getListarEstrategias({id_escenario_nivel2:t.id,id_tipo_solicitud:e?e.id:null})})}filtrarxTipoSolicitud(){let t=this.filtroForm.get("sociedad").value,e=this.filtroForm.get("nivel1").value,i=this.filtroForm.get("nivel2").value,r=this.filtroForm.get("nivel3").value,s=this.filtroForm.get("tipoSolicitud").value;this.getListarEstrategias({id_sociedad:t?t.id:null,id_escenario_nivel1:e?e.id:null,id_escenario_nivel2:i?i.id:null,id_escenario_nivel3:r?r.id:null,id_tipo_solicitud:s?s.id:null})}getListarEstrategias(t){this.listadoEstrategias=[],this.estrategiaService.getListarEstrategias(t).then(t=>{this.listadoEstrategias=t})}crearEstrategia(t){let e=this.filtroForm.get("nivel3").value,i=this.filtroForm.get("tipoSolicitud").value;this.estrategiaService.crearEstrategia({escenario_nivel3:e,tipo_solicitud:i}).then(()=>{this.filtrarxTipoSolicitud(),this._snack.open(this.MENSAJE_REGISTRAR_ESTRATEGIA,"cerrar",{duration:2e3,horizontalPosition:"end",verticalPosition:"top"})}),console.log("crear en la base de datos la estrategia")}openDialogAsignarRoles(t){this.matDialog.open(Kt,{disableClose:!0,data:t}).afterClosed().subscribe(t=>{console.log("The dialog was closed"+JSON.stringify(t)),this.mapRolEstrategia(t)})}mapRolEstrategia(t){this.btnAsignarUsuarioDisabled=!0,t.forEach(t=>{this.btnAsignarUsuarioDisabled=!1})}openDialogAsignarUsuarios(t){this.matDialog.open(N,{disableClose:!0,data:{estrategia:t}}).afterClosed().subscribe(t=>{console.log("The dialog was closed "+JSON.stringify(t))})}openDialogEquivalencias(t){this.matDialog.open(he,{disableClose:!0,data:{id_estrategia:t.id},width:"60%"}).afterClosed().subscribe(t=>{"CONFIRM_DLG_YES"!=t.respuesta&&console.log("se cerr\xf3 el dialog de correos")})}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(s.b),d.Nb(ee.a),d.Nb(a.d),d.Nb(ue.a),d.Nb(ge),d.Nb(be),d.Nb(me.a),d.Nb(pe),d.Nb(re),d.Nb(ie.a),d.Nb(n.b))},t.\u0275cmp=d.Hb({type:t,selectors:[["app-listar-estrategia"]],decls:87,vars:20,consts:[[1,"contentmain"],[1,"breadcumb"],["routerLink","/dashboard/principal"],["routerLink","#"],[1,"bread-item"],[1,"filtros"],[3,"formGroup","ngSubmit"],["cols","6","rowHeight","100px"],["appearance","outline"],["formControlName","sociedad","required","",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"hidden"],["formControlName","nivel1","required","",3,"selectionChange"],["formControlName","nivel2","required","",3,"selectionChange"],["formControlName","nivel3","required","",3,"selectionChange"],["formControlName","tipoSolicitud","required","",3,"selectionChange"],["mat-raised-button","","color","accent","type","submit",3,"disabled"],[1,"content-table"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","sociedad"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","escenario_1"],["matColumnDef","escenario_2"],["matColumnDef","linea_negocio"],["matColumnDef","tipo_solicitud"],["matColumnDef","id_estrategia"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"value"],["mat-header-cell",""],["mat-cell",""],["mat-flat-button","","color","accent",3,"click"],["asignar_rol",""],["asignar_usuario",""],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(d.Tb(0,"div",0),d.Tb(1,"div",1),d.Tb(2,"a",2),d.Tb(3,"mat-icon"),d.Bc(4,"home"),d.Sb(),d.Sb(),d.Tb(5,"a",3),d.Tb(6,"span",4),d.Bc(7," / Administraci\xf3n "),d.Sb(),d.Sb(),d.Tb(8,"a",3),d.Tb(9,"span",4),d.Bc(10," / Estrategias "),d.Sb(),d.Sb(),d.Sb(),d.Ob(11,"br"),d.Tb(12,"div",5),d.Tb(13,"form",6),d.ac("ngSubmit",function(){return e.crearEstrategia(e.filtroForm.value)}),d.Tb(14,"mat-grid-list",7),d.Tb(15,"mat-grid-tile"),d.Tb(16,"mat-form-field",8),d.Tb(17,"mat-label"),d.Bc(18,"Sociedades"),d.Sb(),d.Tb(19,"mat-select",9),d.ac("selectionChange",function(){return e.filtrarNivel1()}),d.Ac(20,fe,2,2,"mat-option",10),d.Sb(),d.Tb(21,"mat-hint"),d.Tb(22,"mat-error",11),d.Bc(23),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(24,"mat-grid-tile"),d.Tb(25,"mat-form-field",8),d.Tb(26,"mat-label"),d.Bc(27,"Escenario nivel 1"),d.Sb(),d.Tb(28,"mat-select",12),d.ac("selectionChange",function(){return e.filtrarNivel2()}),d.Ac(29,_e,2,2,"mat-option",10),d.Sb(),d.Tb(30,"mat-hint"),d.Tb(31,"mat-error",11),d.Bc(32),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(33,"mat-grid-tile"),d.Tb(34,"mat-form-field",8),d.Tb(35,"mat-label"),d.Bc(36,"Escenario nivel 2"),d.Sb(),d.Tb(37,"mat-select",13),d.ac("selectionChange",function(){return e.filtrarNivel3()}),d.Ac(38,ve,2,2,"mat-option",10),d.Sb(),d.Tb(39,"mat-hint"),d.Tb(40,"mat-error",11),d.Bc(41),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(42,"mat-grid-tile"),d.Tb(43,"mat-form-field",8),d.Tb(44,"mat-label"),d.Bc(45,"Linea de Negocio"),d.Sb(),d.Tb(46,"mat-select",14),d.ac("selectionChange",function(){return e.filtrarxTipoSolicitud()}),d.Ac(47,Se,2,2,"mat-option",10),d.Sb(),d.Tb(48,"mat-hint"),d.Tb(49,"mat-error",11),d.Bc(50),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(51,"mat-grid-tile"),d.Tb(52,"mat-form-field",8),d.Tb(53,"mat-label"),d.Bc(54,"Tipo Solicitud"),d.Sb(),d.Tb(55,"mat-select",15),d.ac("selectionChange",function(){return e.filtrarxTipoSolicitud()}),d.Tb(56,"mat-option"),d.Bc(57,"seleccionar"),d.Sb(),d.Ac(58,Ce,2,2,"mat-option",10),d.Sb(),d.Tb(59,"mat-hint"),d.Tb(60,"mat-error",11),d.Bc(61),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(62,"mat-grid-tile"),d.Tb(63,"button",16),d.Bc(64,"Crear Estrategia"),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(65,"div",17),d.Tb(66,"table",18),d.Rb(67,19),d.Ac(68,Ee,2,0,"th",20),d.Ac(69,De,2,1,"td",21),d.Qb(),d.Rb(70,22),d.Ac(71,Re,2,0,"th",20),d.Ac(72,Pe,2,1,"td",21),d.Qb(),d.Rb(73,23),d.Ac(74,Te,2,0,"th",20),d.Ac(75,we,2,1,"td",21),d.Qb(),d.Rb(76,24),d.Ac(77,ye,2,0,"th",20),d.Ac(78,xe,2,1,"td",21),d.Qb(),d.Rb(79,25),d.Ac(80,Oe,2,0,"th",20),d.Ac(81,ke,2,1,"td",21),d.Qb(),d.Rb(82,26),d.Ac(83,Ae,2,0,"th",20),d.Ac(84,Ie,11,0,"td",21),d.Qb(),d.Ac(85,Ne,1,0,"tr",27),d.Ac(86,Le,1,0,"tr",28),d.Sb(),d.Sb(),d.Sb()),2&t&&(d.Cb(13),d.kc("formGroup",e.filtroForm),d.Cb(7),d.kc("ngForOf",e.listadoSociedades),d.Cb(2),d.kc("hidden",!e.formErrors.sociedad),d.Cb(1),d.Dc(" ",e.formErrors.sociedad," "),d.Cb(6),d.kc("ngForOf",e.listadoNivel1),d.Cb(2),d.kc("hidden",!e.formErrors.nivel1),d.Cb(1),d.Dc(" ",e.formErrors.nivel1," "),d.Cb(6),d.kc("ngForOf",e.listadoNivel2),d.Cb(2),d.kc("hidden",!e.formErrors.nivel2),d.Cb(1),d.Dc(" ",e.formErrors.nivel2," "),d.Cb(6),d.kc("ngForOf",e.listadoNivel3),d.Cb(2),d.kc("hidden",!e.formErrors.nivel3),d.Cb(1),d.Dc(" ",e.formErrors.nivel3," "),d.Cb(8),d.kc("ngForOf",e.listadoTipoSolicitud),d.Cb(2),d.kc("hidden",!e.formErrors.tipoSolicitud),d.Cb(1),d.Dc(" ",e.formErrors.tipoSolicitud," "),d.Cb(2),d.kc("disabled",e.filtroForm.invalid),d.Cb(3),d.kc("dataSource",e.listadoEstrategias),d.Cb(19),d.kc("matHeaderRowDef",e.displayedColumns),d.Cb(1),d.kc("matRowDefColumns",e.displayedColumns))},directives:[s.c,C.a,a.w,a.p,a.h,se.a,se.c,b.c,b.g,m.a,a.o,a.g,a.u,r.l,b.f,b.b,S.l,_.a,v.j,v.c,v.e,v.b,v.g,v.i,v.d,v.a,v.f,v.h],styles:[".contentmain[_ngcontent-%COMP%]{padding-left:30px;padding-right:30px;padding-bottom:40px;min-width:800px;margin-top:-10px}.breadcumb[_ngcontent-%COMP%]{height:40px;border-radius:0 0 5px 5px;width:99%;padding-left:10px;padding-top:16px}.breadcumb[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#455a64;font-size:12pt;font-weight:700}mat-icon[_ngcontent-%COMP%]{font-size:18pt}.bread-item[_ngcontent-%COMP%], mat-icon[_ngcontent-%COMP%]{display:block;float:left}.bread-item[_ngcontent-%COMP%]{margin-top:5px}mat-form-field[_ngcontent-%COMP%]{width:70%}table[_ngcontent-%COMP%]{width:100%}.content-table[_ngcontent-%COMP%]{min-width:800px;padding-left:5px;padding-right:5px;padding-top:10px}"]}),t})();var Be=i("wop4");let Me=(()=>{class t{constructor(t){this.resourceService=t}getListarPerfilesUsuario(){let t=[];return new Promise((e,i)=>{this.resourceService.getResource("/maestro/perfilUsuario/listarTodo").toPromise().then(i=>{i&&0!==Object.keys(i).length?(t=i.lista,e(t)):(console.log("no hay perfiles encontrados..."),e([]))}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),i(t)})})}getListarPerfilesUsuarioPendientes(t){let e=[];return new Promise((i,r)=>{this.resourceService.getResource("/usuario/listarPerfilesPendientes?id_usuario="+t).toPromise().then(t=>{t&&0!==Object.keys(t).length?(e=t.lista,i(e)):(console.log("no hay perfiles encontrados..."),i([]))}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),r(t)})})}asignarPerfilUsuario(t){let e;console.log("adding Usuario..."+JSON.stringify(t));let i={id_usuario:t.id_usuario,id_perfil_usuario:t.id_perfil_usuario};return console.log("sending Perfil..."+JSON.stringify(i)),new Promise((t,r)=>{this.resourceService.postResource("/usuario/asignarPerfilAUsuario",i).toPromise().then(i=>{console.log("response data="+JSON.stringify(i)),e=i,t(e)}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),r(t)})})}getListaPerfilesUsuario(t){let e=[];return new Promise((i,r)=>{this.resourceService.getResource("/usuario/listarPerfiles?id_usuario="+t).toPromise().then(t=>{t&&0!==Object.keys(t).length?(e=t,i(e)):(console.log("no hay perfiles de Usuario encontrados..."),i([]))}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),r(t)})})}desasignarPerfilUsuario(t){let e;console.log("sending Item para eliminar Perfil..."+JSON.stringify(t));let i={id_usuario:t.id_usuario,id_perfil_usuario:t.id_perfil_usuario};return new Promise((t,r)=>{this.resourceService.postResource("/usuario/eliminarPerfilDeUsuario",i).toPromise().then(i=>{console.log("response data="+JSON.stringify(i)),e=i,t(e)}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),r(t)})})}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(h.a))},t.\u0275prov=d.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Fe=(()=>{class t{constructor(t){this.resourceService=t}getListarAreasUsuario(){let t=[];return new Promise((e,i)=>{this.resourceService.getResource("/maestro/areaUsuario/listarTodo").toPromise().then(i=>{i&&0!==Object.keys(i).length?(t=i.lista,e(t)):(console.log("no hay areas encontradas..."),e([]))}).catch(t=>{console.log("error status="+t.status+", msg="+t.message),i(t)})})}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(h.a))},t.\u0275prov=d.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function je(t,e){if(1&t&&(d.Tb(0,"mat-option",12),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.kc("value",t.id),d.Cb(1),d.Dc("",t.nombre," ")}}function ze(t,e){1&t&&d.Ob(0,"mat-spinner",13)}let qe=(()=>{class t{constructor(t,e,i,r,s,o,n,c){this.dialogRef=t,this.data=e,this.formBuilder=i,this._snack=r,this.usuarioService=s,this.perfilUsuarioService=o,this.areaUsuarioService=n,this.formValidatorService=c,this.formErrors={usuario:"",nombre:"",perfil_usuario:"",area_usuario:""},this.validationMessages={usuario:{required:"el correo es requerido."},nombre:{required:"el nombre es requerido."},perfil_usuario:{required:"el perfil es requerido."},area_usuario:{required:"el area es requerida."}},this.submitted=!1,this.carga=!1,this.listadoAreas=[],this.listadoPerfiles=[],this.MENSAJE_ACTUALIZAR_USUARIO="Se actualiz\xf3 el usuario correctamente!",this.usuariodata=e,this.editarFormDialog=this.formBuilder.group({id:[this.usuariodata.id],usuario:[this.usuariodata.usuario,a.v.required],nombre:[this.usuariodata.nombre,a.v.required],perfil_usuario:[this.usuariodata.perfil_usuario.id,a.v.required],area_usuario:[this.usuariodata.area_usuario.id,a.v.required]}),this.editarFormDialog.valueChanges.subscribe(()=>{this.formErrors=this.formValidatorService.handleFormChanges(this.editarFormDialog,this.formErrors,this.validationMessages,this.submitted)})}ngOnInit(){this.listarPerfiles(),this.listarAreas()}listarPerfiles(){return Object(o.a)(this,void 0,void 0,function*(){this.listadoPerfiles=yield this.perfilUsuarioService.getListarPerfilesUsuario()})}listarAreas(){return Object(o.a)(this,void 0,void 0,function*(){this.listadoAreas=yield this.areaUsuarioService.getListarAreasUsuario()})}actualizarUsuario(t){this.usuarioService.actualizarUsuario(t).then(t=>{this._snack.open(this.MENSAJE_ACTUALIZAR_USUARIO,"cerrar",{duration:2e3,horizontalPosition:"end",verticalPosition:"top"}),this.dialogRef.close(this.usuariodata)})}onNoClick(){this.dialogRef.close(this.usuariodata)}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(n.d),d.Nb(n.a),d.Nb(a.d),d.Nb(ee.a),d.Nb(Be.a),d.Nb(Me),d.Nb(Fe),d.Nb(ie.a))},t.\u0275cmp=d.Hb({type:t,selectors:[["app-editar-usuario"]],decls:33,vars:8,consts:[[1,"contenidoForm"],[3,"formGroup","ngSubmit"],["cols","2","rowHeight","100px"],["appearance","outline"],["matInput","","placeholder","Correo","formControlName","usuario","required",""],[3,"hidden"],["matInput","","placeholder","nombre","formControlName","nombre","required",""],["formControlName","area_usuario","required",""],[3,"value",4,"ngFor","ngForOf"],["class","spinner","diameter","40","color","accent","strokeWidth","7",4,"ngIf"],["mat-raised-button","","color","default","type","button",3,"click"],["mat-raised-button","","color","accent","type","submit"],[3,"value"],["diameter","40","color","accent","strokeWidth","7",1,"spinner"]],template:function(t,e){1&t&&(d.Tb(0,"h3"),d.Bc(1),d.Sb(),d.Tb(2,"div",0),d.Tb(3,"form",1),d.ac("ngSubmit",function(){return e.actualizarUsuario(e.editarFormDialog.value)}),d.Tb(4,"mat-grid-list",2),d.Tb(5,"mat-grid-tile"),d.Tb(6,"mat-form-field",3),d.Tb(7,"mat-label"),d.Bc(8,"Correo"),d.Sb(),d.Ob(9,"input",4),d.Tb(10,"mat-hint"),d.Tb(11,"mat-error",5),d.Bc(12),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(13,"mat-grid-tile"),d.Tb(14,"mat-form-field",3),d.Tb(15,"mat-label"),d.Bc(16,"Nombre"),d.Sb(),d.Ob(17,"input",6),d.Sb(),d.Tb(18,"mat-hint"),d.Tb(19,"mat-error",5),d.Bc(20),d.Sb(),d.Sb(),d.Sb(),d.Tb(21,"mat-grid-tile"),d.Tb(22,"mat-form-field",3),d.Tb(23,"mat-label"),d.Bc(24,"Area"),d.Sb(),d.Tb(25,"mat-select",7),d.Ac(26,je,2,2,"mat-option",8),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Ac(27,ze,1,0,"mat-spinner",9),d.Tb(28,"button",10),d.ac("click",function(){return e.onNoClick()}),d.Bc(29,"Cerrar Ventana"),d.Sb(),d.Bc(30," \xa0 "),d.Tb(31,"button",11),d.Bc(32,"Actualizar Usuario"),d.Sb(),d.Sb(),d.Sb()),2&t&&(d.Cb(1),d.Dc("Editar Usuario: ",e.usuariodata.nombre,""),d.Cb(2),d.kc("formGroup",e.editarFormDialog),d.Cb(8),d.kc("hidden",!e.formErrors.usuario),d.Cb(1),d.Dc(" ",e.formErrors.usuario," "),d.Cb(7),d.kc("hidden",!e.formErrors.nombre),d.Cb(1),d.Dc(" ",e.formErrors.nombre," "),d.Cb(6),d.kc("ngForOf",e.listadoAreas),d.Cb(1),d.kc("ngIf",e.carga))},directives:[a.w,a.p,a.h,se.a,se.c,b.c,b.g,p.b,a.c,a.o,a.g,a.u,b.f,b.b,m.a,r.l,r.m,_.a,S.l,E.b],styles:[".spinner[_ngcontent-%COMP%]{position:relative;display:block;margin-left:448px;margin-bottom:10px}.contenidoForm[_ngcontent-%COMP%]{width:500px;height:auto}mat-form-field[_ngcontent-%COMP%]{width:80%}"]}),t})();function Je(t,e){if(1&t&&(d.Tb(0,"mat-option",15),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.kc("value",t),d.Cb(1),d.Dc(" ",t.nombre," ")}}function Ge(t,e){1&t&&(d.Tb(0,"th",16),d.Bc(1," Perfil"),d.Sb())}function He(t,e){if(1&t&&(d.Tb(0,"td",17),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.Cb(1),d.Dc(" ",t.nombre," ")}}function Ve(t,e){1&t&&(d.Tb(0,"th",16),d.Bc(1," Acciones "),d.Sb())}function $e(t,e){if(1&t){const t=d.Ub();d.Tb(0,"td",17),d.Tb(1,"button",18),d.ac("click",function(){d.tc(t);const i=e.$implicit;return d.ec().eliminarPerfil(i)}),d.Tb(2,"mat-icon"),d.Bc(3,"delete"),d.Sb(),d.Sb(),d.Sb()}}function Qe(t,e){1&t&&d.Ob(0,"tr",19)}function Xe(t,e){1&t&&d.Ob(0,"tr",20)}function We(t,e){1&t&&d.Ob(0,"mat-spinner",21)}let Ze=(()=>{class t{constructor(t,e,i,r){this.dialogRef2=t,this.data=e,this.perfilUsuarioService=i,this._snack=r,this.comboListadoPerfilesPendientes=[],this.carga=!1,this.listadoPerfiles=[],this.displayedColumns=["perfil","acciones"],this.MENSAJE_ASIGNAR_PERFIL="Se asign\xf3 un perfil a su usuario!",this.MENSAJE_QUITAR_PERFIL="Se retir\xf3 un perfil a su usuario!",console.log(JSON.stringify(e)),this.usuario=e}ngOnInit(){this.getPerfilesPendientes(),this.listarPerfilesUsuario()}listarPerfilesUsuario(){this.perfilUsuarioService.getListaPerfilesUsuario(this.usuario.id).then(t=>{console.log("los perfiles son :"+JSON.stringify(t)),this.listadoPerfiles=t.lista})}getPerfilesPendientes(){this.perfilUsuarioService.getListarPerfilesUsuarioPendientes(this.usuario.id).then(t=>{console.log("los perfiles son :"+JSON.stringify(t)),this.comboListadoPerfilesPendientes=t})}asignarPerfil(t){this.perfilUsuarioService.asignarPerfilUsuario({id_usuario:this.usuario.id,id_perfil_usuario:t.id}).then(t=>{console.log("se asign\xf3 el perfil "+JSON.stringify(t)),this._snack.open(this.MENSAJE_ASIGNAR_PERFIL,"cerrar",{duration:2e3,horizontalPosition:"end",verticalPosition:"top"}),this.getPerfilesPendientes(),this.listarPerfilesUsuario()})}eliminarPerfil(t){this.perfilUsuarioService.desasignarPerfilUsuario({id_usuario:this.usuario.id,id_perfil_usuario:t.id}).then(t=>{console.log("se desasign\xf3 el usuario"+JSON.stringify(t)),this._snack.open(this.MENSAJE_QUITAR_PERFIL,"cerrar",{duration:2e3,horizontalPosition:"end",verticalPosition:"top"}),this.listarPerfilesUsuario(),this.getPerfilesPendientes()})}onNoClick(){this.dialogRef2.close(this.listadoPerfiles)}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(n.d),d.Nb(n.a),d.Nb(Me),d.Nb(ee.a))},t.\u0275cmp=d.Hb({type:t,selectors:[["app-asignar-perfil-usuario"]],decls:27,vars:7,consts:[[1,"contentDialog"],["appearance","fill"],["name","item",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-raised-button","","color","accent",3,"click"],[1,"content-table"],["mat-table","",1,"at-elevation-z8",3,"dataSource"],["matColumnDef","perfil"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","spinner","diameter","40","color","accent","strokeWidth","7",4,"ngIf"],["mat-raised-button","","color","default",3,"click"],[3,"value"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","accent",3,"click"],["mat-header-row",""],["mat-row",""],["diameter","40","color","accent","strokeWidth","7",1,"spinner"]],template:function(t,e){1&t&&(d.Tb(0,"h3"),d.Bc(1,"Asignar Perfil Usuario : "),d.Tb(2,"b"),d.Bc(3),d.Sb(),d.Sb(),d.Tb(4,"div",0),d.Tb(5,"mat-form-field",1),d.Tb(6,"mat-label"),d.Bc(7,"Seleccionar Perfil"),d.Sb(),d.Tb(8,"mat-select",2),d.ac("ngModelChange",function(t){return e.selectedPerfil=t}),d.Ac(9,Je,2,2,"mat-option",3),d.Sb(),d.Sb(),d.Bc(10,"\n\xa0\n"),d.Tb(11,"button",4),d.ac("click",function(){return e.asignarPerfil(e.selectedPerfil)}),d.Bc(12,"Agregar"),d.Sb(),d.Tb(13,"div",5),d.Tb(14,"table",6),d.Rb(15,7),d.Ac(16,Ge,2,0,"th",8),d.Ac(17,He,2,1,"td",9),d.Qb(),d.Rb(18,10),d.Ac(19,Ve,2,0,"th",8),d.Ac(20,$e,4,0,"td",9),d.Qb(),d.Ac(21,Qe,1,0,"tr",11),d.Ac(22,Xe,1,0,"tr",12),d.Sb(),d.Sb(),d.Ob(23,"br"),d.Ac(24,We,1,0,"mat-spinner",13),d.Tb(25,"button",14),d.ac("click",function(){return e.onNoClick()}),d.Bc(26,"Cerrar Ventana"),d.Sb(),d.Sb()),2&t&&(d.Cb(3),d.Cc(e.usuario.nombre),d.Cb(5),d.kc("ngModel",e.selectedPerfil),d.Cb(1),d.kc("ngForOf",e.comboListadoPerfilesPendientes),d.Cb(5),d.kc("dataSource",e.listadoPerfiles),d.Cb(7),d.kc("matHeaderRowDef",e.displayedColumns),d.Cb(1),d.kc("matRowDefColumns",e.displayedColumns),d.Cb(2),d.kc("ngIf",e.carga))},directives:[b.c,b.g,m.a,a.o,a.r,r.l,_.a,v.j,v.c,v.e,v.b,v.g,v.i,r.m,S.l,v.d,v.a,C.a,v.f,v.h,E.b],styles:[".contentDialog[_ngcontent-%COMP%]{width:450px}.content-table[_ngcontent-%COMP%], .contentDialog[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px;padding-top:10px}.content-table[_ngcontent-%COMP%]{min-width:400px}"]}),t})();function Ye(t,e){if(1&t&&(d.Tb(0,"mat-option",35),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.kc("value",t.id),d.Cb(1),d.Dc("",t.nombre," ")}}function Ke(t,e){if(1&t&&(d.Tb(0,"mat-option",35),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.kc("value",t.id),d.Cb(1),d.Dc(" ",t.nombre," ")}}function ti(t,e){1&t&&(d.Tb(0,"th",36),d.Bc(1," Correo "),d.Sb())}function ei(t,e){if(1&t&&(d.Tb(0,"td",37),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.Cb(1),d.Dc(" ",t.usuario," ")}}function ii(t,e){1&t&&(d.Tb(0,"th",36),d.Bc(1," Nombre "),d.Sb())}function ri(t,e){if(1&t&&(d.Tb(0,"td",37),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.Cb(1),d.Dc(" ",t.nombre," ")}}function si(t,e){1&t&&(d.Tb(0,"th",36),d.Bc(1," Area "),d.Sb())}function oi(t,e){if(1&t&&(d.Tb(0,"td",37),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.Cb(1),d.Dc(" ",t.area_usuario.nombre," ")}}function ni(t,e){1&t&&(d.Tb(0,"th",36),d.Bc(1," Perfil "),d.Sb())}function ai(t,e){if(1&t&&(d.Tb(0,"td",37),d.Bc(1),d.Sb()),2&t){const t=e.$implicit;d.Cb(1),d.Dc(" ",t.perfil_usuario.nombre," ")}}function ci(t,e){1&t&&(d.Tb(0,"th",36),d.Bc(1," Acciones "),d.Sb())}function li(t,e){if(1&t){const t=d.Ub();d.Tb(0,"td",37),d.Tb(1,"button",38,39),d.ac("click",function(){d.tc(t);const i=e.$implicit;return d.ec().openDialogAsignarPerfiles(i)}),d.Bc(3," Asignar Perfil "),d.Sb(),d.Bc(4," \xa0 "),d.Tb(5,"button",38,39),d.ac("click",function(){d.tc(t);const i=e.$implicit;return d.ec().openDialogEditar(i)}),d.Bc(7," Editar "),d.Sb(),d.Sb()}}function di(t,e){1&t&&d.Ob(0,"tr",40)}function hi(t,e){1&t&&d.Ob(0,"tr",41)}const ui=[{path:"",redirectTo:"estrategias",pathMatch:"full"},{path:"estrategias",component:Ue},{path:"usuarios",component:(()=>{class t{constructor(t,e,i,r,s,o,n){this._snack=t,this.formBuilder=e,this.formValidatorService=i,this.matDialog=r,this.usuarioService=s,this.areaUsuarioService=o,this.perfilUsuarioService=n,this.displayedColumns=["usuario","nombre","area_usuario","perfil_usuario","id"],this.listadoUsuarios=[],this.formErrors={usuario:"",nombre:"",perfil_usuario:"",area_usuario:""},this.validationMessages={usuario:{required:"el correo es requerido."},nombre:{required:"el nombre es requerido."},area_usuario:{required:"el area es requerida."}},this.submitted=!1,this.listadoAreas=[],this.listadoPerfiles=[],this.MENSAJE_DESHABILITAR_USUARIO="Se cambi\xf3 la actividad del usuario!",this.MENSAJE_CREAR_USUARIO="Se registr\xf3 el usuario correctamente!",this.filtroForm=this.formBuilder.group({usuario:["",a.v.required],nombre:["",a.v.required],perfil_usuario:[""],area_usuario:["",a.v.required]}),this.filtroForm.valueChanges.subscribe(()=>{this.formErrors=this.formValidatorService.handleFormChanges(this.filtroForm,this.formErrors,this.validationMessages,this.submitted)})}ngOnInit(){this.getListarAreas(),this.getListarPerfiles()}getListarAreas(){return Object(o.a)(this,void 0,void 0,function*(){this.listadoAreas=yield this.areaUsuarioService.getListarAreasUsuario()})}getListarPerfiles(){return Object(o.a)(this,void 0,void 0,function*(){this.listadoPerfiles=yield this.perfilUsuarioService.getListarPerfilesUsuario()})}crearUsuario(t){this.usuarioService.crearUsuario(t).then(t=>{1==t.resultado?(this._snack.open(this.MENSAJE_CREAR_USUARIO,"cerrar",{duration:2e3,horizontalPosition:"end",verticalPosition:"top"}),this.filtrarUsuarios()):(this._snack.open(t.mensaje,"cerrar",{duration:2e3,horizontalPosition:"end",verticalPosition:"top"}),this.filtrarUsuarios())})}toggleUsuario(t){this.usuarioService.activarUsuario(t).then(t=>{1==t.resultado&&this._snack.open(this.MENSAJE_DESHABILITAR_USUARIO,"cerrar",{duration:2e3,horizontalPosition:"end",verticalPosition:"top"})}).finally(()=>this.filtrarUsuarios())}filtrarUsuarios(){return Object(o.a)(this,void 0,void 0,function*(){let t={usuario:this.filtroForm.get("usuario").value,nombre:this.filtroForm.get("nombre").value,id_perfil_usuario:this.filtroForm.get("perfil_usuario").value,id_area_usuario:this.filtroForm.get("area_usuario").value};yield this.usuarioService.getListarUsuarioPorFiltros(t).then(t=>{this.listadoUsuarios=t})})}openDialogEditar(t){this.matDialog.open(qe,{disableClose:!0,data:t}).afterClosed().subscribe(t=>{this.filtrarUsuarios()})}openDialogAsignarPerfiles(t){this.matDialog.open(Ze,{disableClose:!0,data:t}).afterClosed().subscribe(t=>{this.filtrarUsuarios()})}limpiarUsuario(){this.filtroForm.get("usuario").setValue(""),this.filtroForm.get("nombre").setValue(""),this.filtroForm.get("area_usuario").setValue("")}test(t){console.log("al escribir me pasan esto: "+JSON.stringify(t))}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(ee.a),d.Nb(a.d),d.Nb(ie.a),d.Nb(n.b),d.Nb(Be.a),d.Nb(Fe),d.Nb(Me))},t.\u0275cmp=d.Hb({type:t,selectors:[["app-listar-usuario"]],decls:79,vars:7,consts:[[1,"contentmain"],[1,"breadcumb"],["routerLink","/dashboard/principal"],["routerLink","#"],[1,"bread-item"],[1,"filtros"],[3,"formGroup","ngSubmit"],["cols","12","rowHeight","90px"],["colspan","3"],[1,"izquierda"],["appearance","outline"],["matInput","","placeholder","Correo","formControlName","usuario","required","",3,"keyup"],["usuarioText",""],["matInput","","placeholder","nombre","formControlName","nombre","required","",3,"keyup"],["formControlName","area_usuario","required","",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["mat-raised-button","","color","accent","type","submit",3,"disabled"],["mat-raised-button","","color","accent","type","button",3,"click"],["colspan","9"],["colspan","2"],["appearance","standard"],["formControlName","perfil_usuario"],["colspan","1"],["mat-mini-fab","","color","accent","type","button",3,"click"],[1,"content-table"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","usuario"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nombre"],["matColumnDef","area_usuario"],["matColumnDef","perfil_usuario"],["matColumnDef","id"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"value"],["mat-header-cell",""],["mat-cell",""],["mat-flat-button","",1,"boton-secundario",3,"click"],["asignar_rol",""],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(d.Tb(0,"div",0),d.Tb(1,"div",1),d.Tb(2,"a",2),d.Tb(3,"mat-icon"),d.Bc(4,"home"),d.Sb(),d.Sb(),d.Tb(5,"a",3),d.Tb(6,"span",4),d.Bc(7," / Administraci\xf3n "),d.Sb(),d.Sb(),d.Tb(8,"a",3),d.Tb(9,"span",4),d.Bc(10," / Usuarios "),d.Sb(),d.Sb(),d.Sb(),d.Ob(11,"br"),d.Tb(12,"div",5),d.Tb(13,"form",6),d.ac("ngSubmit",function(){return e.crearUsuario(e.filtroForm.value)}),d.Tb(14,"mat-grid-list",7),d.Tb(15,"mat-grid-tile",8),d.Tb(16,"div",9),d.Tb(17,"mat-form-field",10),d.Tb(18,"mat-label"),d.Bc(19,"Correo"),d.Sb(),d.Tb(20,"input",11,12),d.ac("keyup",function(){return e.filtrarUsuarios()}),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(22,"mat-grid-tile",8),d.Tb(23,"div",9),d.Tb(24,"mat-form-field",10),d.Tb(25,"mat-label"),d.Bc(26,"Nombre"),d.Sb(),d.Tb(27,"input",13),d.ac("keyup",function(){return e.filtrarUsuarios()}),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(28,"mat-grid-tile",8),d.Tb(29,"div",9),d.Tb(30,"mat-form-field",10),d.Tb(31,"mat-label"),d.Bc(32,"Area"),d.Sb(),d.Tb(33,"mat-select",14),d.ac("selectionChange",function(){return e.filtrarUsuarios()}),d.Tb(34,"mat-option"),d.Bc(35,"Seleccione"),d.Sb(),d.Ac(36,Ye,2,2,"mat-option",15),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(37,"mat-grid-tile",8),d.Tb(38,"div",9),d.Tb(39,"button",16),d.Bc(40,"Crear Usuario"),d.Sb(),d.Bc(41," \xa0 "),d.Tb(42,"button",17),d.ac("click",function(){return e.limpiarUsuario()}),d.Bc(43,"Limpiar Usuario"),d.Sb(),d.Sb(),d.Sb(),d.Ob(44,"mat-grid-tile",18),d.Tb(45,"mat-grid-tile",19),d.Tb(46,"div",9),d.Tb(47,"mat-form-field",20),d.Tb(48,"mat-label"),d.Bc(49,"Buscar por perfil"),d.Sb(),d.Tb(50,"mat-select",21),d.Tb(51,"mat-option"),d.Bc(52,"Seleccione"),d.Sb(),d.Ac(53,Ke,2,2,"mat-option",15),d.Sb(),d.Sb(),d.Bc(54," \xa0 "),d.Sb(),d.Sb(),d.Tb(55,"mat-grid-tile",22),d.Tb(56,"div",9),d.Tb(57,"button",23),d.ac("click",function(){return e.filtrarUsuarios()}),d.Tb(58,"mat-icon"),d.Bc(59,"search"),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(60,"div",24),d.Tb(61,"table",25),d.Rb(62,26),d.Ac(63,ti,2,0,"th",27),d.Ac(64,ei,2,1,"td",28),d.Qb(),d.Rb(65,29),d.Ac(66,ii,2,0,"th",27),d.Ac(67,ri,2,1,"td",28),d.Qb(),d.Rb(68,30),d.Ac(69,si,2,0,"th",27),d.Ac(70,oi,2,1,"td",28),d.Qb(),d.Rb(71,31),d.Ac(72,ni,2,0,"th",27),d.Ac(73,ai,2,1,"td",28),d.Qb(),d.Rb(74,32),d.Ac(75,ci,2,0,"th",27),d.Ac(76,li,8,0,"td",28),d.Qb(),d.Ac(77,di,1,0,"tr",33),d.Ac(78,hi,1,0,"tr",34),d.Sb(),d.Sb(),d.Sb()),2&t&&(d.Cb(13),d.kc("formGroup",e.filtroForm),d.Cb(23),d.kc("ngForOf",e.listadoAreas),d.Cb(3),d.kc("disabled",e.filtroForm.invalid),d.Cb(14),d.kc("ngForOf",e.listadoPerfiles),d.Cb(8),d.kc("dataSource",e.listadoUsuarios),d.Cb(16),d.kc("matHeaderRowDef",e.displayedColumns),d.Cb(1),d.kc("matRowDefColumns",e.displayedColumns))},directives:[s.c,C.a,a.w,a.p,a.h,se.a,se.c,b.c,b.g,p.b,a.c,a.o,a.g,a.u,m.a,S.l,r.l,_.a,v.j,v.c,v.e,v.b,v.g,v.i,v.d,v.a,v.f,v.h],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%!important}.content-table[_ngcontent-%COMP%]{margin-top:-20px}"]}),t})()}];let gi=(()=>{class t{}return t.\u0275mod=d.Lb({type:t}),t.\u0275inj=d.Kb({factory:function(e){return new(e||t)},imports:[[s.d.forChild(ui)],s.d]}),t})();var bi=i("Wp6s"),mi=i("STbY");let pi=(()=>{class t{}return t.\u0275mod=d.Lb({type:t}),t.\u0275inj=d.Kb({factory:function(e){return new(e||t)},imports:[[r.c,gi,se.b,bi.e,m.b,_.b,C.b,a.j,p.c,v.k,a.t,Vt.b,n.c,mi.a,Ht,f.b,E.a],E.a]}),t})()}}]);